{
  "title": "RTL: If already landing, go straight to RTL_LAND",
  "url": "https://github.com/PX4/PX4-Autopilot/pull/10044",
  "number": 10044,
  "created_at": "2018-07-25T20:59:44Z",
  "merged": true,
  "merged_at": "2018-07-26T05:46:26Z",
  "state": "closed",
  "conversation": {
    "author": "dakejahl",
    "body": "**Test data / coverage**\nTested issuing a `land` command followed by an `rtl` command in gazebo. Vehicle continues to descend as expected.\n\n**Describe problem solved by the proposed pull request**\nRTL interrupts a land. This is an issue if an operator is trying to land the vehicle and a critically low battery triggers an RTL. We have seen many times the vehicle takeoff back into the air (RTL) when it is about to touch down for landing.\n\n**Describe your preferred solution**\nDo not allow RTL to `CLIMB` if already `position_setpoint_s::SETPOINT_TYPE_LAND`\n\n_I also cleaned up the comments, removed unnecessary includes, and got rid of namepacing_",
    "issue_comments": [
      {
        "author": "dagar",
        "created_at": "2018-07-25T22:07:54Z",
        "body": "We actually have to be a little careful here that the current position setpoint is still valid. The other option which might be safer overall is to go straight into RTL land if transitioning from the LAND navigation state.",
        "type": "issue_comment"
      },
      {
        "author": "LorenzMeier",
        "created_at": "2018-07-26T05:46:21Z",
        "body": "Thanks, perfect!",
        "type": "issue_comment"
      }
    ],
    "review_comments": [
      {
        "author": "dagar",
        "created_at": "2018-07-25T22:05:47Z",
        "body": "This should be okay if you also check `current.valid`.",
        "path": "src/modules/navigator/rtl.cpp",
        "position": 1,
        "type": "review_comment"
      }
    ],
    "reviews": [
      {
        "author": "LorenzMeier",
        "created_at": "",
        "body": "",
        "state": "APPROVED",
        "type": "review"
      }
    ]
  }
}