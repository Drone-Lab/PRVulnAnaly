[
  {
    "title": "rc.fw_defaults param fix",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4121",
    "number": 4121,
    "created_at": "2016-03-30T16:25:38Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "dagar",
      "body": "",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-30T16:27:31Z",
          "body": "Thanks!\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-30T16:30:46Z",
          "body": "Applied to master!\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "fixing possible safety issue with altitude",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4081",
    "number": 4081,
    "created_at": "2016-03-26T02:38:11Z",
    "merged": true,
    "merged_at": "2016-03-26T13:36:34Z",
    "state": "closed",
    "conversation": {
      "author": "catch-twenty-two",
      "body": "Ignoring requested altitude from target for now.\n",
      "issue_comments": [],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "more param metadata cleanup",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4078",
    "number": 4078,
    "created_at": "2016-03-25T20:30:01Z",
    "merged": true,
    "merged_at": "2016-03-26T11:17:52Z",
    "state": "closed",
    "conversation": {
      "author": "dagar",
      "body": "",
      "issue_comments": [],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "added descend into navigator",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4068",
    "number": 4068,
    "created_at": "2016-03-23T21:53:09Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "pickledgator",
      "body": "Descend was unimplemented in navigator, and thus had no effect when the navigation state was changed. Utilized same land helper. Downstream logic in pos_control and commander successfully ignore position data that is applied in the setpoint message. Tested in gazebo for multi-rotors.\n",
      "issue_comments": [
        {
          "author": "julianoes",
          "created_at": "2016-03-24T08:11:05Z",
          "body": "Nice catch. How did you find this, in which scenario did the bug show up?\n",
          "type": "issue_comment"
        },
        {
          "author": "pickledgator",
          "created_at": "2016-03-24T22:41:56Z",
          "body": "To support development, I needed a way to trigger a failsafe landing without xy position control, even when position data is available in the filter (eg., bad VO). Descend nav state provides the control mechanism that I desired, and I piped an RC channel to a new failsafe main state to trigger the Descend.\n",
          "type": "issue_comment"
        },
        {
          "author": "mhkabir",
          "created_at": "2016-03-25T00:23:40Z",
          "body": "@pickledgator Sounds nice! Would you be able to send in a PR with the rest of your changes ? It would be very useful for others using VO too :)\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-28T10:27:37Z",
          "body": "Rebased and applied, thanks!\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "Follow me",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4065",
    "number": 4065,
    "created_at": "2016-03-23T19:14:10Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "LorenzMeier",
      "body": "@catch-twenty-two Replacing your PR with this rebased and formatted version.\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-23T19:38:15Z",
          "body": "@catch-twenty-two What is the current state of this right now? Do you have an updated video?\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-23T19:39:30Z",
          "body": "Matching QGC PR, not merged yet and with CI errors: https://github.com/mavlink/qgroundcontrol/pull/2817\n",
          "type": "issue_comment"
        },
        {
          "author": "catch-twenty-two",
          "created_at": "2016-03-23T21:19:59Z",
          "body": "@LorenzMeier Great thanks for doing that, No updated video yet. I did go out with friend to test it on a bicycle so I could see how well it tracked a fast moving object and all went well.  I'll do one more test tomorrow with all the updated changes and then call it good.  I'll also I'll see if I can get some more video if possible.\n",
          "type": "issue_comment"
        },
        {
          "author": "liang-tang",
          "created_at": "2016-03-24T07:33:01Z",
          "body": "@catch-twenty-two Is there a bug?\n\n``` javascript\nvoid FollowTarget::update_position_sp(bool use_velocity, bool use_position)\n{\n    // convert mission item to current setpoint\n\n    struct position_setpoint_triplet_s *pos_sp_triplet = _navigator->get_position_setpoint_triplet();\n\n    // activate line following in pos control if position is valid\n\n    pos_sp_triplet->previous.valid = use_position;\n    pos_sp_triplet->previous = pos_sp_triplet->current;\n    mission_item_to_position_setpoint(&_mission_item, &pos_sp_triplet->current);\n    pos_sp_triplet->current.type = position_setpoint_s::SETPOINT_TYPE_FOLLOW_TARGET;\n    pos_sp_triplet->current.position_valid = use_position;\n    pos_sp_triplet->current.velocity_valid = use_velocity;\n    pos_sp_triplet->current.vx = _current_vel(0);\n    pos_sp_triplet->current.vy = _current_vel(1);\n    pos_sp_triplet->next.valid = false;\n    _navigator->set_position_setpoint_triplet_updated();\n}\n```\n\n   pos_sp_triplet->current.valid is miss? control_auto couldn't work well if we missed it. when i switch to follow target mode, the vehicle isn't moving at all.\n",
          "type": "issue_comment"
        },
        {
          "author": "catch-twenty-two",
          "created_at": "2016-03-24T19:53:45Z",
          "body": "@LorenzMeier Happy to report I went out today and everything worked great.  I have some video but my I'll have to see if it's worth posting.\n",
          "type": "issue_comment"
        },
        {
          "author": "catch-twenty-two",
          "created_at": "2016-03-24T20:04:58Z",
          "body": "> pos_sp_triplet->current.valid is miss? control_auto couldn't work well if we missed it. when i switch to follow target mode, the vehicle isn't moving at all.\n\nHmmm...you are right.  I'm actually surprised my tests went okay today, odd.... Good catch.  I'll have to fix it and retest tomorrow. \n\nNevermind see here where the sp is marked as valid:\n\nhttps://github.com/PX4/Firmware/pull/4065/files#diff-c8b2face30ea93f334a64cf7f9aff096L83\n\nThere could possibly be something wrong with your gps...Do you have another phone you can try?\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-24T20:13:09Z",
          "body": "I always love videos, so I hope it turns out well!\n",
          "type": "issue_comment"
        },
        {
          "author": "DonLakeFlyer",
          "created_at": "2016-03-24T22:20:28Z",
          "body": "My suggestion for basic follow me support would be to maintain the current height of the Vehicle. Also mantain the current distance/positioning from the target calculated from the first follow me message.\n",
          "type": "issue_comment"
        },
        {
          "author": "catch-twenty-two",
          "created_at": "2016-03-25T03:40:04Z",
          "body": "I'm no filmmaker... which is very apparent from this video, it contains:\n\n1) Me walking with follow me mode activated.\n2) My mother who I recruited to help me, walking with follow me mode activated (all the rest of my friends are at work on weekday mornings, imagine that! :) )\n3) Me riding my Xooter Scooter that I use to get around San Francisco, with follow me activated. At this point I was actually brave enough to set the RC down so I had no safety net (if anything were to go wrong) and let my code do it's work....\n\nThere was a slight wind blowing probably around 7-10 mph the frame type is a DJI style 330. \n\n> I always love videos, so I hope it turns out well!\n\n@LorenzMeier Did it turn out well?  Not really. But hopefully your love of videos makes up for that. lol!\n\nhttps://youtu.be/RxDL4CtkzAQ\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-27T10:17:47Z",
          "body": "Awesome, merged! Now on to the QGC merge, @DonLakeFlyer!\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "VTOL_TAKEOFF, VTOL_LAND commands and VT_FORCE_VTOL param",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4055",
    "number": 4055,
    "created_at": "2016-03-22T10:30:16Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "sanderux",
      "body": "support for MAV_CMD_NAV_VTOL_TAKEOFF and MAV_CMD_NAV_VTOL_LAND \nAlso implement VT_FORCE_VTOL to force land as VTOL\nreplaces https://github.com/PX4/Firmware/pull/3720\n\nFixes #3492\nFixes #3712\n",
      "issue_comments": [
        {
          "author": "sanderux",
          "created_at": "2016-03-24T00:14:26Z",
          "body": "@AndreasAntener I cleaned up the mission code, sanitized the functionality, improved back transition behavior, fixed alignment and implemented force_vtol procedure.\nSITL tested all reasonable scenarios and regression tested on the old procedure (takeoff -> trans -> wp -> trans -> land).\n\nI'm especially happy with the back transition improvement, we could see if the basis could change from time to velocity but for now this seems to be a big improvement.\n\nI will test fly this tree soon but i think it is ready to rebase and merge as i see no possible regression and it only implements previously unsupported functionality.\n\nSomehow this tagged along through a submodule init and causes travis to fail: https://github.com/PX4/Firmware/pull/4055/files#diff-d62dbab64e619e0e5926b64585204efdR1\nI think that should be resolved by rebasing but i'm not sure.\n\n/cc @LorenzMeier @tumbili \n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-03-24T09:04:46Z",
          "body": "@sanderux Could you rebase and squash the development commits? There are also wrong indentations in the mission code it seems\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-24T11:02:40Z",
          "body": "@AndreasAntener @sanderux There is a 15 character limit on parameter length, what I proposed works, what you proposed doesn't.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-03-24T11:11:00Z",
          "body": "@LorenzMeier I tested VT_NAV_FORCE_VTL as param and that works. Do you want me to change it?\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-24T11:13:09Z",
          "body": "16 is the hard limit without NUL-termination. It should work, but you can get yourself into corner cases in downstream implementations. I suggest to use VT_NAV_FORCE_VT instead.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-03-24T11:20:04Z",
          "body": "ready to merge\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-24T12:03:20Z",
          "body": "Is this state SITL and outdoor tested? I think it should be, as the changes are significant.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-03-24T12:10:05Z",
          "body": "Sitl is tested, outdoor tomorrow\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-03-25T20:34:02Z",
          "body": "Outdoor tested in quite strong wind. \nhttp://logs.uaventure.com/view/JRG4pRghKoV3RK8eS3o75k#AS_Yaw_PLOT\n\n1 There was a sudden unintended yaw action when front transition started, see yaw setpoint change\n2 Very smooth back transition but quite a high time and in strong winds it drifts a lot \n3 During lading it weathervaned and got lift from it's wings, it therefor acted up a little.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-03-25T21:49:39Z",
          "body": "Here is a second log:\nhttp://logs.uaventure.com/view/PJYu2ARidpuQyFsX9qxdKm\n\nThe yaw setpoint issue is consistent\nThe airspeed sensor for the quadranger acted up here (turned out to be the radio telem being too close)\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-03-26T18:04:08Z",
          "body": "This should fix the yaw issue during transition\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-03-27T01:13:09Z",
          "body": "@sanderux before I forget, mission item reached: one reason to not wait on the transition to be finished is that the position controller won't know the next waypoint and therefore cannot control the position during the transition in case we later implement this. haven't thought about it in detail though.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-03-27T08:16:59Z",
          "body": "the advantage of this command is that the user can point the vehicle into the wind. It is basically the autonomous equivlant of flicking the aux1 switch.\n\nFor position control it should hold altitude and heading until ttansition has completed or timeout occurs. \n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-03-27T09:34:31Z",
          "body": "Sure but it's changing the behaviour in general, also for the separate transitions (not part of VTOL tko/lnd). What we talked about yesterday, if we want the FW position controller to guide it through blending, it needs to know the next waypoint. If it doesn't get the actual next mission waypoint, we need to generate a temporary waypoint that lies in the direction of the target transition heading. Another option would be to look at the \"next\" waypoint in the triplet, which contains the next position during the transition. Ok, I think we have 2 good options here so it's fine.\n\nNote: simply holding heading and attitude is not going to work, it will drift off path.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-03-27T09:45:41Z",
          "body": "Yes your right, i think a temp waypoint would be a good idea.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-27T10:27:38Z",
          "body": "Waiting for conclusive test flights to merge this.\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-03-27T10:31:39Z",
          "body": "I did a sitl test to check on the Z velocity issue that i see in your log from #4079:\n\n<img width=\"1368\" alt=\"screen shot 2016-03-27 at 12 15 55\" src=\"https://cloud.githubusercontent.com/assets/5750020/14064961/98febe76-f416-11e5-9277-f6557dca7d42.png\">\n\nThe position controller still sees a takeoff type setpoint during the transition. Needs to be reset, should be a small fix.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-03-27T23:48:12Z",
          "body": "@AndreasAntener do you agree on the location of setting the setpoint type?\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-03-29T21:06:49Z",
          "body": "@AndreasAntener i added the virtual waypoint in front of the takeoff item. This should work fine now with your transition position holding\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-03-30T11:51:22Z",
          "body": "Here is a log for a SITL flight based on this branch combined with https://github.com/PX4/Firmware/pull/4093. looks very smooth and functions as expected.\nhttp://logs.uaventure.com/view/VXJnLmimbG8px8aiuPtBja\n\n![image](https://cloud.githubusercontent.com/assets/14801663/14141202/fab81b6c-f67d-11e5-8f05-aa66601c9d1f.png)\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-04-02T18:20:36Z",
          "body": "Outdoor tested, looking good:\nhttp://logs.uaventure.com/view/jg2rHZDRmAboYLiqyFVuge\nVideo: https://drive.google.com/file/d/0B27AvDmVit4KQlpCMllyaDVxQmM/view?usp=sharing\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-04-02T20:29:55Z",
          "body": "Rebased and applied, thanks!\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-24T08:31:49Z",
          "body": "This should be defined in the navigator params, (NAV_FORCE_VTOL), as its only used there.\n",
          "path": "src/modules/vtol_att_control/vtol_att_control_params.c",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-03-24T08:59:09Z",
          "body": "All vtol related params start with VT_ perhaps VT_NAV_FORCE_VTOL ?\n",
          "path": "src/modules/vtol_att_control/vtol_att_control_params.c",
          "position": 1,
          "type": "review_comment"
        }
      ],
      "reviews": []
    }
  },
  {
    "title": "MissionFeasibilityChecker geofence ignore NAV_CMD_DO_*",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4046",
    "number": 4046,
    "created_at": "2016-03-21T03:39:11Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "dagar",
      "body": "-closes #4040\n",
      "issue_comments": [
        {
          "author": "dagar",
          "created_at": "2016-03-21T14:59:29Z",
          "body": "Thanks @AndreasAntener \nIs there a better place a helper like item_contains_position() could live in navigator? At the moment I made it public and static within MissionBlock so it was accessible from MissionFeasibilityChecker.\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-03-21T19:24:30Z",
          "body": "Only idea I'd have would be to add a helper class, but it's a bit overkill atm for one method. Maybe add a comment about it.\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-03-22T00:21:41Z",
          "body": "Added todo\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-03-22T05:56:18Z",
          "body": "Thanks, applied\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [
        {
          "author": "AndreasAntener",
          "created_at": "2016-03-21T13:10:07Z",
          "body": "We could use https://github.com/PX4/Firmware/blob/master/src/modules/navigator/mission_block.cpp#L318 and also add NAV_CMD_DO_JUMP to the list there (it's currently not because it's handled separately in missions but adding it won't have any other effect)\n",
          "path": "src/modules/navigator/mission_feasibility_checker.cpp",
          "position": 1,
          "type": "review_comment"
        }
      ],
      "reviews": []
    }
  },
  {
    "title": "reset mission after vehicle was in mission and then disarms",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4043",
    "number": 4043,
    "created_at": "2016-03-20T13:46:35Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "AndreasAntener",
      "body": "Fixes #3978 , SITL tested\nPlease review\n\nNote: I had the reset code in commander first but that didn't feel right so I moved it to mission. There might be a better way to trigger the reset instead via the `offboard_mission` topic.\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-20T13:56:32Z",
          "body": "Changes / architecture looks good.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-24T14:06:58Z",
          "body": "I commented on this. I think it needs to be done solely in the navigator without intervention from the commander.\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-03-25T09:25:53Z",
          "body": "@LorenzMeier makes sense, will fix this\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-03-27T02:02:24Z",
          "body": "Updated, SITL tested.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-27T10:27:01Z",
          "body": "Looked good, sane and safe, so I applied it to master, thanks!\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-24T14:05:18Z",
          "body": "Why is this logic in the commander after all? Can't the navigator just do this by itself, since it knows the current flight mode?\n",
          "path": "src/modules/commander/commander.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-24T14:05:49Z",
          "body": "This introduces a race with the mavlink app, which also publishes this topic. If we publish something from the commander, it would need to be done on a different topic.\n",
          "path": "src/modules/commander/commander.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-24T14:06:28Z",
          "body": "Would prefer to trigger this on a vehicle status change with state == mission and disarmed.\n",
          "path": "src/modules/navigator/mission.cpp",
          "position": 1,
          "type": "review_comment"
        }
      ],
      "reviews": []
    }
  },
  {
    "title": "Reset current setpoint when entering RTL",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4012",
    "number": 4012,
    "created_at": "2016-03-14T21:53:11Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "AndreasAntener",
      "body": "Fixes #3844 \nSITL tested\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-14T22:08:12Z",
          "body": "Sounds like we should merge this once Travis passes.\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-03-14T22:38:15Z",
          "body": "Rebased, I was a bit out of date..\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-19T15:30:39Z",
          "body": "Rebased and applied.\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "Param unit cleanup",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4000",
    "number": 4000,
    "created_at": "2016-03-13T18:28:53Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "dagar",
      "body": "",
      "issue_comments": [
        {
          "author": "dagar",
          "created_at": "2016-03-13T20:46:47Z",
          "body": "@LorenzMeier @DonLakeFlyer ready for review please\n\nCurrent @unit usage\n\n```\n  4  * @unit 1/s\n  1  * @unit A\n  1  * @unit bit/s\n 44  * @unit boolean\n 40  * @unit deg\n  4  * @unit deg * 1e7\n 19  * @unit deg/s\n 54  * @unit enum\n  1  * @unit Gauss\n  1  * @unit Gauss/s\n  1  * @unit hPa\n  5  * @unit Hz\n  1  * @unit kg\n  3  * @unit kg*m^2\n 47  * @unit m\n  1  * @unit m^2\n  1  * @unit mA\n  1  * @unit min\n  1  * @unit m/m\n 12  * @unit ms\n  1  * @unit m-s\n 35  * @unit m/s\n  2  * @unit (m/s)-s\n 10  * @unit m/s/s\n  1  * @unit (m/s/s)-s\n  1  * @unit rad\n  8  * @unit rad/s\n 26  * @unit s\n  7  * @unit SD\n 66  * @unit us\n  3  * @unit V\n  1  * @unit W\n```\n",
          "type": "issue_comment"
        },
        {
          "author": "DonLakeFlyer",
          "created_at": "2016-03-13T20:54:19Z",
          "body": "I'd probably change the seconds ones to secs, msecs, usecs. A little more clear. What is SD?\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-03-13T20:59:14Z",
          "body": "It's in ekf2 so I left it alone. Standard deviation?\nhttps://github.com/PX4/Firmware/blob/cecec86081566f243a0dec33b9dedc3dd1624f58/src/modules/ekf2/ekf2_params.c#L316\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-03-13T21:22:40Z",
          "body": "I used s, ms, us to stick to SI, but if you want the abbreviation I'll change them.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-14T08:13:14Z",
          "body": "Rebased and applied.\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "Mode switch fix",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3998",
    "number": 3998,
    "created_at": "2016-03-13T10:49:13Z",
    "merged": true,
    "merged_at": "2016-03-13T14:55:11Z",
    "state": "closed",
    "conversation": {
      "author": "LorenzMeier",
      "body": "",
      "issue_comments": [
        {
          "author": "kd0aij",
          "created_at": "2016-03-13T12:54:57Z",
          "body": "Very nice, the comments will be very valuable to future maintenance coders.\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "FW navigator accept TAKEOFF waypoint like MC (alt only)",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3922",
    "number": 3922,
    "created_at": "2016-03-04T20:36:10Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "dagar",
      "body": "I think this makes the most sense for fixed wing behaviour. You're still flying towards the takeoff waypoint, but once you actually hit the altitude (within NAV_ACC_RAD) you're ready to proceed with the mission. \n",
      "issue_comments": [
        {
          "author": "dagar",
          "created_at": "2016-03-04T21:24:06Z",
          "body": "I was also thinking about updating MissionFeasibilityChecker. What would be appropriate?\n\n-require altitude greater than: At least home + climbout_diff + nav_acc_rad or MIS_TAKEOFF_ALT?\n-minimum distance >= FW_AIRSPEED_TRIM \\* FW_T_CLMB_MAX meters from home.\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-03-05T10:35:21Z",
          "body": "Both options are not ideal. Caring for horizontal position might make it turn too soon, caring for altitude might make it spiral where you don't want it. At least with the way it is now you know what it will do (because you have the next waypoint in mind). The spiral might be completely unexpected. But other than that I can't really argue for one or the other.\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-03-05T14:19:03Z",
          "body": "I'm more concerned with the current situation making it accept too soon when you should still be climbing with roll constrained and TECS in climbout mode. With the roll limited to [-15, 15] during altitude_error > _parameters.climbout_diff the potential spiral is pretty limited depending on your FW_CLMBOUT_DIFF and NAV_ACC_RAD.\n\nA fairly common situation is hand launching into wind where the plane climbs quickly and easily hits the takeoff altitude early. Why fly to a fairly low waypoint instead of continuing the mission?\n\nThink of the takeoff waypoint as more of a cmd to launch + climb with its location not necessarily important.\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-03-05T14:48:38Z",
          "body": "You can't just assume that the takeoff position is not important to the user.\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-03-05T14:50:09Z",
          "body": "What your thinking off is not flying a mission but just flying manually where only the climbout diff is relevant.\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-03-05T16:16:53Z",
          "body": "It's not necessarily assuming the takeoff position isn't important to the user (it would still be mostly respected if climbout diff > accept radius), but rather I'm trying to tweak what we already have to get the behaviour I want. Maybe that's the wrong approach.\n\nSo let's take a step back and have the proper discussion. I want to hand launch in AUTO, sometimes with launch detect, sometimes without and have that launch do nothing but safely climb in the direction I throw until a certain altitude, and then continue/start the mission. How could we accomplish this while still having the option of respecting a takeoff waypoint position?\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-03-05T17:17:20Z",
          "body": "Ok. Wasn't it your plan to reuse the runway takeoff code for hand launch too? I believe it would give you exactly what you want. In \"heading mode\" it will takeoff to climbout alt in the direction you threw it, and then navigate towards takeoff wp. In \"wp mode\" will directly try to navigate towards the takeoff waypoint (which is the default behaviour at the moment I guess?).\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-03-05T18:04:24Z",
          "body": "You're right that will probably be exactly what I want in most cases if I just treat the takeoff waypoint like my first regular waypoint. My only concern then is the possibility that the waypoint could be accepted before RunwayTakeoffState::FLY. What would be the best way to prevent that?\n\nAdditionally check climbout diff to accept NAV_CMD_TAKEOFF or actually publish takeoff state?\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "navigator only accept waypoint if !landed",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3908",
    "number": 3908,
    "created_at": "2016-03-02T15:17:42Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "dagar",
      "body": "This also includes a minor fw_pos_control_l1 cleanup where the const arg pos_sp_triplet and _pos_sp_triplet were being used interchangeably.\n\nPossible fix for #3902\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-03T09:10:41Z",
          "body": "Looking good to me. It still will require putting takeoff waypoints at a suitable minimum distance - which probably needs to be fixed in the GCS.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-03T09:16:06Z",
          "body": "The change looked anyway good, so I cherry-picked it it onto master. Closing.\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "Loiter min altitude: Differentiate between loiter and takeoff",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3880",
    "number": 3880,
    "created_at": "2016-02-28T19:34:17Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "LorenzMeier",
      "body": "This should help with suddenly rising systems.\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-14T08:05:44Z",
          "body": "Rebased and applied.\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "FW airspeed mode",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3861",
    "number": 3861,
    "created_at": "2016-02-25T22:54:46Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "dagar",
      "body": "This pull request introduces fixed wing airspeed mode. Airspeed mode is the minimum manual mode that's appropriate (safe) for an operator without RC experience.\nIt's a stabilized mode with manual throttle and airspeed controlled with the pitchstick. It feels similar to STAB, but you can't stall the plane.\n\n**Questions**\n- ~~where should this fit in with the existing modes and switches?~~\n- ~~this mode is much better with the TECS time constant significantly reduced, could it scale automatically?~~ You just need to properly tune TECS\n- ~~this doesn't currently work with mTecs, does anyone use it?~~\n- ~~should this mode respect FW_THR_MIN/FW_THR_MAX?~~\n",
      "issue_comments": [
        {
          "author": "dagar",
          "created_at": "2016-02-26T21:46:05Z",
          "body": "I tested most combinations of mode transitions to and from airspeed mode HIL today and didn't see any obvious problems.\nLog muncher might be broken: http://logs.uaventure.com/view/GcnQdeGGB4qgMJDwX8HQng\n\nReinitializing TECS between airspeed mode and any other TECS mode is a bit abrupt, I'm going to try just resetting speed weight and the underspeed check instead.\n\nI'll try an actual flight next week.\n",
          "type": "issue_comment"
        },
        {
          "author": "SimonWilks",
          "created_at": "2016-02-26T22:36:31Z",
          "body": "Logmuncher is working again for this log. Something odd happened with it.\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-02-26T23:04:18Z",
          "body": "The throttle transition from airspeed mode full throttle to altctl is pretty bad. Rethinking the way I'm abusing TECS.\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-02-27T19:35:36Z",
          "body": "Ok, back to where I started. TECS is completely reset between AIRSPEED and ALTCTL/POSCTL/AUTO. It's no worse than switching from MAN/STAB to those modes.\n\nI still want to think about automatically reducing the TECS time constant just in this mode, but I'm otherwise happy with the state of this during HIL testing and ready for an actual flight test.\n\n@LorenzMeier would you recommend flying master as of today, or should I cherry-pick this to stable?\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-02-28T20:39:41Z",
          "body": "I've cherry-picked to stable for flight testing. https://github.com/PX4/Firmware/compare/stable...dagar:fw_airspeed_mode-stable?expand=1\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-03-01T01:59:31Z",
          "body": "@SimonWilks is this new mode killing logmuncher? http://logs.uaventure.com/view/tNysut35PRAqfF8qe2xhr7\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-03-02T19:38:08Z",
          "body": "Here's a plot from a successful flight of airspeed mode (ported to stable). The plot shows airspeed setpoint changing with elevator input, and manual throttle. This section of the flight was ALTCLT -> AIRSPEED -> ALTCTL with no problems. Altitude is scaled by 0.1.\n\n![airspeed_1](https://cloud.githubusercontent.com/assets/84712/13472651/da1750cc-e083-11e5-8311-97aa4b797d38.png)\n\n@LorenzMeier what are the next steps? What testing would you like to see?\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-03-02T20:15:34Z",
          "body": "This confused me a bit so I hope you don't mind my questions. I had to look in the code to understand how this is supposed to work ;).\n\nHow is this different from altitude control from the users perspective? Maybe you could explain a bit where the need for this mode is coming from?\n\nDon't you have 2 inputs that have an effect on altitude now? So I'm assuming thrust is your main altitude control now (with speed-weight 2). But also if you change the airspeed setpoint TECS will have to dive/climb (because it has no other means anymore of matching the speed)?\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-03-02T20:56:18Z",
          "body": "Think of it as a safe manual mode. Similar to stabilized mode, but the autopilot maintains a safe airspeed [FW_AIRSPEED_MIN, FW_AIRSPEED_MAX] at all times to prevent the vehicle from stalling. It's very useful for manually landing a UAV. In a locked down configuration for a user this would be their manual mode (which they wouldn't expect to hold altitude).\n\nThis airspeed mode is actually what several commercial UAVs and autopilots refer to as manual mode.\n\nYou should try it in a simulator with appropriate min, trim, and max airspeeds and possibly reducing the TECS time constant. It feels like flying in stabilize mode, but the pitch responds a bit slower.\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-03-02T21:39:04Z",
          "body": "Landing, that's interesting. I mean, you have the same problem here as in alt/posctl: you cannot flare. How does the stick movement look for a landing? Wouldn't you want to reduce airspeed AND throttle for a landing?\n\nNaive question: have you tried plain altitude control with a reduced TECS time constant? I know you don't have manual throttle there, just wondering if the control feeling would already be better then.\n\n> This airspeed mode is actually what several commercial UAVs and autopilots refer to as manual mode.\n\nCould you give me an example? (because I'm curious, not because I don't believe you :))\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-03-04T16:45:49Z",
          "body": "Actually you can flare by pulling the pitch stick completely back, assuming you approach above min airspeed. Having direct control over throttle makes this mode much safer than ALTCTL for handling on the ground at launch or landing.\n\nI haven't tried ALTCTL with a reduced TECS time constant, but I generally use it when I want to just stay at the same altitude and not think about it.\n\nThe Procerus Kestrel autopilot (acquired by Lockheed) and fixed wing UAVs from AeroVironment refer to this as manual mode.\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-03-09T20:52:36Z",
          "body": "@LorenzMeier @AndreasAntener do you have any other questions? What's the path forward for getting this merged? \n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-03-15T01:13:55Z",
          "body": "Rebased and resolved conflict.\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-03-20T18:36:48Z",
          "body": "<a href=\"https:&#x2F;&#x2F;trello.com&#x2F;c&#x2F;IvXjv34B&#x2F;723-px4-airspeed-mode-test\"><img src=\"https:&#x2F;&#x2F;github.trello.services&#x2F;images&#x2F;trello-icon.png\" width=\"12\" height=\"12\"> PX4 airspeed mode test</a>\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-24T15:24:59Z",
          "body": "@dagar I can't access that Trello card.\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-03-24T15:29:02Z",
          "body": "Whoops, sorry that's my personal todo list that I had no idea was posting on my behalf.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-24T15:29:07Z",
          "body": "Another rebase would be great, and more clarity on testing - would it be possible for you to test this, position control, altitude control and an auto mission? I would also love to understand the time constant change you mentioned.\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-04-02T16:16:37Z",
          "body": "I've flown this a couple times and it works as intended with no problems, but the airspeed response isn't great. I've been having a hard time tuning TECS to respond nicely for this mode, but still work well normally.\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-04-04T07:36:58Z",
          "body": "@dagar What about leaving airspeed control away if within min/max? There is a lot of talk about stall prevention ATM. I believe your reasoning behind this \"airspeed\" mode is not different from people simply requesting stall prevention methods. Maybe it could be more of a mix, having manual throttle/pitch/roll control, but start limiting pitch/roll when airspeed gets borderline, and use TECS to pitch down if airspeed falls below min.\n",
          "type": "issue_comment"
        },
        {
          "author": "tubeme",
          "created_at": "2016-04-04T22:16:18Z",
          "body": "@dagar Sounds very promising.\n\n@AndersonRayner Here is what the APM is doing about stall:\n\n> when in roll controlled modes the autopilot will monitor your demanded bank angle and airspeed and work out if you have sufficient margin above the stall speed to turn at the demanded bank angle. If you donâ€™t then the turn will be limited to the safe limit, but it will always allow a bank of at least 25 degrees (to ensure you can still maneuver if your airspeed estimate is badly off).\n\nWe've seen this technique in other two more simpler controllers and it works.\n\n> when in auto-throttle modes the autopilot will also raise the minimum airspeed in the TECS system to the level at which the current demanded bank angle can be safely achieved. So it will add more engine power or lower the nose to raise the airspeed so that the bank angle that the navigation controller is demanding can be achieved without a stall\n\nThey use these two parameters:\n\n> The **STALL_PREVENTION** parameter. If this is set to zero then no stall prevention is done. This may be useful if you have no airspeed sensor and the synthetic airspeed estimate is not good \n> enough\n> \n> The **ARSPD_FBW_MIN** parameter, which is the configured minimum airspeed for level flight. It is this value that is scaled with the bank angle to calculate the safe airspeed for any demanded bank angle\n\nI'm not saying we have to copy, but there is not a big choice of approaches toward stall. It is classical physics.  \n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-04-05T03:01:31Z",
          "body": "@AndreasAntener how would we keep TECS happy/initialized in between?\n\nHopefully I'll have some time to play around again later this week. I'll provide some plots of pitch input and response. It should be possible to get it to respond nicely when you're within the airspeed limits. Worst case I'll try doing airspeed control with only pitch outside of TECS.\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-04-13T22:28:47Z",
          "body": "Rebased on master. I've been trying to gain a better understanding of TECS so that I can figure out how to make this mode work nicely. Update coming soon.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-05-22T10:35:10Z",
          "body": "@dagar Where is this standing?\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-05-22T18:35:47Z",
          "body": "Waiting for me to actually go to the field and fly.\n",
          "type": "issue_comment"
        },
        {
          "author": "jcooper21",
          "created_at": "2016-05-27T05:29:49Z",
          "body": "This looks like a great mode. I may have some spare time coming up to test this mode and provide feedback. Is it in PX4 beta or master build and in the daily build of QGC?\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-05-28T18:24:03Z",
          "body": "TODO - only allow transition to this mode for fixed wing\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-05-28T18:27:35Z",
          "body": "@jcooper21 this hasn't been tested since a large rebase so I need to spend some time at the field.\n\nIf you haven't already I'd suggest you thoroughly tune TECS.\n\nhttps://pixhawk.org/users/fixedwing_pid_tuning#tecs_tuning_altitude\n\nThe ArduPlane documentation is good, but many of the params are named differently.\nhttp://ardupilot.org/plane/docs/tecs-total-energy-control-system-for-speed-height-tuning-guide.html\n",
          "type": "issue_comment"
        },
        {
          "author": "jcooper21",
          "created_at": "2016-05-28T19:05:13Z",
          "body": "My tuning should be good. I'll test this when I get back from my vacation in a while. I'd this going to be the new stabalize mode? Also if it controls min air speed how do I land?\n",
          "type": "issue_comment"
        },
        {
          "author": "jcooper21",
          "created_at": "2016-05-28T19:58:53Z",
          "body": "Is this in QGC daily and px4 matter so I can set it up to test?\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-06-05T23:03:57Z",
          "body": "I'll reopen this once I've had a few thorough flight tests with data and it's ready to be merged immediately.\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "Clean up vehicle_status message",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3846",
    "number": 3846,
    "created_at": "2016-02-24T18:17:26Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "julianoes",
      "body": "Do not merge yet, untested, just for review.\n\nThis is work in progress trying to clean up the vehicle_status message.\nCurrent changes include:\n- Remove circuit breakers from vehicle_status\n- Delete mavlink compatible fields which were not in sync anymore.\n- Move vtol_vehicle_status enum to vtol_status topic.\n- Move battery calculations to the respective drivers (sensors.cpp and px4io.cpp).\n- Move battery data to battery_status topic.\n- Internalize condition bools into commander and out of vehicle_status.\n- Use land_detected message everywhere instead of the landed bool in vehicle_status.\n\nFor more detailed explanations, please read through the commit messages.\n\nThis PR is now on top of #3857.\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-24T18:24:59Z",
          "body": "Architectural implications / cleanup looks good.\n",
          "type": "issue_comment"
        },
        {
          "author": "julianoes",
          "created_at": "2016-02-26T13:04:28Z",
          "body": "@LorenzMeier Any idea why the mavlink include doesn't work in travis:\nhttps://travis-ci.org/PX4/Firmware/jobs/111996908#L625\n\nIf I use the exact same command on my machine, it works.\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-02-26T15:48:27Z",
          "body": "Have you tried `#include <v1.0/common/mavlink.h>`?\n",
          "type": "issue_comment"
        },
        {
          "author": "julianoes",
          "created_at": "2016-02-26T16:07:52Z",
          "body": "@dagar thanks, I'll give it a try.\n",
          "type": "issue_comment"
        },
        {
          "author": "jschall",
          "created_at": "2016-02-27T00:36:09Z",
          "body": "@julianoes looks like there's some ros stuff failing CI tests (src/platforms/ros/nodes/commander/commander.cpp). Looks like it is simple to fix. Should I address problems with it? Can I be made a collaborator here so that I can push to the branch?\n\n@LorenzMeier what is the timeline like for getting this pushed in once it passes CI tests?\n\n@liamstask fyi\n",
          "type": "issue_comment"
        },
        {
          "author": "jschall",
          "created_at": "2016-02-27T00:43:44Z",
          "body": "Which target should I build to reproduce the error? I tried ros_sitl_default but it said that target was deprecated and to use posix_sitl_default (which works)\n",
          "type": "issue_comment"
        },
        {
          "author": "liamstask",
          "created_at": "2016-02-28T01:04:46Z",
          "body": "@LorenzMeier any pointers on debugging the travis failures per @jschall's questions above?\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-02-28T02:46:23Z",
          "body": "@jschall you can open a pull request onto this branch. It looks like you just need to update the ros commander node to use the new commander_state.\n",
          "type": "issue_comment"
        },
        {
          "author": "jschall",
          "created_at": "2016-02-29T07:30:06Z",
          "body": "There's a new \"commander_state\" message but no one publishes it as far as I can tell.\n",
          "type": "issue_comment"
        },
        {
          "author": "julianoes",
          "created_at": "2016-02-29T09:22:30Z",
          "body": "@jschall :\n\n> looks like there's some ros stuff failing CI tests (src/platforms/ros/nodes/commander/commander.cpp). Looks like it is simple to fix. Should I address problems with it? Can I be made a collaborator here so that I can push to the branch?\n\nI didn't know about this ROS stuff, let me have a look.\n\n> There's a new \"commander_state\" message but no one publishes it as far as I can tell.\n\nOh, good catch. I'll add that.\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-29T16:47:58Z",
          "body": "Jenkins: test this please\n",
          "type": "issue_comment"
        },
        {
          "author": "julianoes",
          "created_at": "2016-03-03T13:24:53Z",
          "body": "I rebased this once again on master. Every time there is some conflicts, so it would be good to flight test this and merge as soon as possible.\n\n@tumbili any chance you could give this a flight test (in the snow :smile:)?\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-04-08T08:12:17Z",
          "body": "Jenkins: test this please\n",
          "type": "issue_comment"
        },
        {
          "author": "julianoes",
          "created_at": "2016-04-08T13:49:52Z",
          "body": "@LorenzMeier and @liamstask\n\nThis would be ready to be merged, I've test flown it today. However, I'd like to hold off the merge until Monday in case it breaks somebody's setup because I'll be offline and not able to resolve conflicts or help debug problems.\n",
          "type": "issue_comment"
        },
        {
          "author": "liamstask",
          "created_at": "2016-04-08T15:09:05Z",
          "body": "sounds good!\n",
          "type": "issue_comment"
        },
        {
          "author": "julianoes",
          "created_at": "2016-04-11T16:42:21Z",
          "body": "Rebased and applied!\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "Px4.enhancement.3760.implement auto follow me.wip [WIP do not merge]",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3814",
    "number": 3814,
    "created_at": "2016-02-21T03:50:56Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "catch-twenty-two",
      "body": "adds ability for px4 firmware to track a target.  Implements rudimentary following of target position in navigator.\n\nNote: this uses a new version of the mavlink library with the proposed follow target method, will not work with current mavlink library version.\n\nhttps://github.com/catch-twenty-two/mavlink\n\nAlso uses new version of qground control with follow me option implemented:\n\nhttps://github.com/mavlink/qgroundcontrol/pull/2817\n\nSome concerns:\n\nPlease comment on ideas for error checking on bad position sent from tracker.  (e.g. ignore tracker if new pos vector is x meters away and instead just loiter)\n\nDoes it make sense for the \"follow previous - current line\" following be activated for this?  (currently I have it activated) I guess this might come in handy for intermittent GPS being sent...\n\nIn both instances ( \"follow previous - current line\" on and off) the result is \"jumpy\" if the new sp is to close to the current set point. \n\nMaybe this entire follow feature needs to be treated more like an instance using the position control code, except instead of manual input it gets tracker input. Or maybe it needs to be some type of hybrid of both pos control and auto line/position following code.\n\nAnyways, just some ideas, I'd like to get other's suggestions. \n\n@LorenzMeier had suggested using a predictive model if we have the target velocity. (this doesn't seem to be an option on my nexus 7 as it doesn't seem to output gps velocity)\n\nHere is a video of the current implementation, Qground control has been coded to send out sinusoidal gps coors, you can see the jumpiness I am referring to:\n\nhttps://www.youtube.com/watch?v=qGC464eVI5E&feature=youtu.be\n",
      "issue_comments": [
        {
          "author": "devbharat",
          "created_at": "2016-02-21T08:37:25Z",
          "body": "This reminded me of the target following I had implemented in APM a few years ago (used the same fixed wing libraries (l1 with TECS) as we do now) and the issues I faced. I did it by setting the target's position as the waypoints for the 'follower' (also I think I overwrote the current target waypoint with the latest waypoint I received from the target. Otherwise, the follower's position oscillated heavily). \nThis strategy 'works' but you end up with steady state error between the target(say, moving in a straight line) and the follower (who never got directly in line behind the target, was always a bit to the left or the right). This can be seen in the following pic:\n\n![dsc_0615](https://cloud.githubusercontent.com/assets/3105122/13201714/9179428e-d87d-11e5-9f86-2a6d8ccab171.JPG)\n\nYou can see the green plane (fixed wing UAV) is following not directly behind the leader, but to the side. This was because unlike a single static waypoint, the waypoints in this case were constantly overwritten to the new target position values, with the controller never getting the time to correct the steady state error. This made me feel that, atleast for fixedwings, tracking moving targets required something more than just setting moving waypoints from the controls point of view.\n\nYou can see a mission with 3 aircrafts daisy-chained here:\n![3-ac-lf-2013-09-28 13_41_29](https://cloud.githubusercontent.com/assets/3105122/13201743/7d2f5934-d87e-11e5-85f1-1635b420890e.png)\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-22T11:58:54Z",
          "body": "Awesome! I'm not so worried about the back and forth as my intention was not to keep sending a specific setpoint all the time, but to implement a \"rubber-band\" controller in that navigator class which trades smoothness for accuracy and only updates the next position gradually.\n\nWhat I however indeed forgot is that we need to feed a desired velocity. That should be supported by the triplet as well. Or we can go straight to the position setpoint instead. I need to think about that and maybe we can discuss this on the dev call?\n",
          "type": "issue_comment"
        },
        {
          "author": "catch-twenty-two",
          "created_at": "2016-02-22T14:27:58Z",
          "body": "> What I however indeed forgot is that we need to feed a desired velocity. That should be supported by the triplet as well. Or we can go straight to the position setpoint instead. I need to think about that and maybe we can discuss this on the dev call?\n\nOkay sounds good. Ill be on the call this morning, interested in hearing more about the controller you have in mind.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-01T08:16:38Z",
          "body": "@catch-twenty-two Any update on the current state? Could you push your latest commits so others have a chance to review and join in?\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-01T08:17:03Z",
          "body": "You also might want to rebase. We kept improving the sim, in particular Gazebo, quite a bit.\n",
          "type": "issue_comment"
        },
        {
          "author": "catch-twenty-two",
          "created_at": "2016-03-12T22:16:07Z",
          "body": "@LorenzMeier Sorry your request got lost in all the noise of my email in box.  The first iteration of the px4 side of the firmware code should be complete now.  Over all operation is a lot smoother.\n",
          "type": "issue_comment"
        },
        {
          "author": "liang-tang",
          "created_at": "2016-03-14T06:56:16Z",
          "body": "@catch-twenty-two I reviewed your code. You can use a pixhawk & mavros to send waypoint message include gps velocity. run rosrun mavros gcs_bridge, roslaunch mavros px4.launch.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-14T07:44:34Z",
          "body": "@liang-tang You missed the intent of this PR. It does follow-me without a companion computer. So what you describe is not of interest here.\n",
          "type": "issue_comment"
        },
        {
          "author": "liang-tang",
          "created_at": "2016-03-15T10:01:32Z",
          "body": "@catch-twenty-two\n\n `if (_pos_sp_triplet.current.type == position_setpoint_s::SETPOINT_TYPE_FOLLOW_TARGET) {\n                    _vel_sp(0) = _pos_sp_triplet.current.vx;\n                    _vel_sp(1) = _pos_sp_triplet.current.vy;\n                } else if (vel_norm_xy > _params.vel_max(0)) {\n                    /* note assumes vel_max(0) == vel_max(1) */\n                    _vel_sp(0) = _vel_sp(0) * _params.vel_max(0) / vel_norm_xy;\n                    _vel_sp(1) = _vel_sp(1) * _params.vel_max(1) / vel_norm_xy;\n                }`\nThere is a bug that _pos_sp_triplet.current.valid should be valid.\n",
          "type": "issue_comment"
        },
        {
          "author": "catch-twenty-two",
          "created_at": "2016-03-15T18:29:39Z",
          "body": "@liang-tang True probably better to double check than assume if you are in follow target mode you have a velocity to use.  I have since changed this entire statement to use the velocity setpoint type and made some other significant changes as well.\n",
          "type": "issue_comment"
        },
        {
          "author": "catch-twenty-two",
          "created_at": "2016-03-17T16:23:41Z",
          "body": "Hello, this is ready for testing if anyone has some time available. Integration to get the system working can be a bit of a pain because it involves changes in qgc, mavlink and px4 fw.  It also requires an Android device with OTG and GPS capability. Let me know if you're interested. Thanks!\n\n@julianoes @tumbili: @LorenzMeier said I should request validation testing from you so we can pull this into master. \n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-17T19:13:17Z",
          "body": "CI failed, fix would be great. Can you also help to get the required PR for QGC through? Then it will be available on Android automatically.\n",
          "type": "issue_comment"
        },
        {
          "author": "catch-twenty-two",
          "created_at": "2016-03-17T22:48:10Z",
          "body": "@LorenzMeier Sure will do\n",
          "type": "issue_comment"
        },
        {
          "author": "liang-tang",
          "created_at": "2016-03-18T01:05:05Z",
          "body": "@catch-twenty-two Testing is in process.\n",
          "type": "issue_comment"
        },
        {
          "author": "catch-twenty-two",
          "created_at": "2016-03-18T03:44:10Z",
          "body": "@liang-tang Great thanks, make sure you grab the latest code, for now I have set the minimum altitude of follow me/missions to 10 meters above home for safety.  If you have changed the mission minimum altitude to something custom for now make sure it set to at least 10m. \n",
          "type": "issue_comment"
        },
        {
          "author": "catch-twenty-two",
          "created_at": "2016-03-19T04:06:46Z",
          "body": "@LorenzMeier I was able to get the CI to pass by changing the mavlink submodule to point to a temporary branch with the new follow target messages...Once the pr with the new messages are approved in the mavlink repo here:\n\nhttps://github.com/mavlink/mavlink/pull/526\n\n can switch it back to pointing to the correct repo and it should build ok without the hack.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-19T07:27:40Z",
          "body": "@catch-twenty-two Will start to integrate this tonight, so will be done in your morning.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-19T14:28:26Z",
          "body": "MAVLink PR is in. Now moving on to do a final review here and get it in.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-19T14:48:19Z",
          "body": "Almost all changes look good, except for the multi rotor position control where I see changes which will affect the general flight behaviour. When this is resolved it should be good to go.\n\nI brought in the MAVLink changes in master (c27981d), please rebase.\n",
          "type": "issue_comment"
        },
        {
          "author": "catch-twenty-two",
          "created_at": "2016-03-19T16:09:24Z",
          "body": "> Almost all changes look good, except for the multi rotor position control where I see changes which will affect the general flight behaviour. When this is resolved it should be good to go.\n> \n> I brought in the MAVLink changes in master (c27981d), please rebase.\n\nThanks, I addressed your concerns in the comments lmk what you think.  Will do the rebase asap.\n",
          "type": "issue_comment"
        },
        {
          "author": "liang-tang",
          "created_at": "2016-03-21T02:22:42Z",
          "body": "@catch-twenty-two  I have some advise to give you.\n\n``` ruby\nvoid FollowTarget::pause()\n{\n    //math::Vector<3> vel(0, 0, 0);\n    _current_vel.zero();\n\n    set_loiter_item(&_mission_item, _param_min_alt.get());\n\n    //update_position_sp(vel);\n\n    _previous_target_gps_pos_valid = false;\n    //_current_target_motion.lat = _navigator->get_global_position()->lat;\n    //_current_target_motion.lon = _navigator->get_global_position()->lon;\n    //mavlink_log_info(_navigator->get_mavlink_fd(),\"pause\");\n}\n```\n\nI think _previous_target_gps_pos_valid should reset to false when pause status, so _target_vel is really valid when update_target_velocity() next time.\n\n``` ruby\nvoid FollowTarget::update_target_motion()\n{\n    bool updated;\n\n    orb_check(_follow_target_sub, &updated);\n\n    if (updated) {\n\n        // save last known motion topic\n\n        _previous_target_motion = _current_target_motion;\n\n        orb_copy(ORB_ID(follow_target), _follow_target_sub, &_current_target_motion);\n\n        update_target_velocity();\n\n        if (_previous_target_gps_pos_valid == false) {\n            _previous_target_motion = _current_target_motion;\n            _previous_target_gps_pos_valid = true;\n        }\n```\n\n if  _current_target_motion is Null, _target_vel will be wrong when update_target_velocity(). So can it be modified like this?\n\n``` ruby\n        if (_previous_target_gps_pos_valid == false) {\n            _previous_target_motion = _current_target_motion;\n            _previous_target_gps_pos_valid = true;\n        }\n\n        update_target_velocity();\n```\n",
          "type": "issue_comment"
        },
        {
          "author": "catch-twenty-two",
          "created_at": "2016-03-21T15:45:43Z",
          "body": "@LorenzMeier Hey Lorenz,  I got rid of the SETPOINT_TYPE_VELOCITY statement by checking if the velocity or position setpoints are valid in the setpoint triplet.  This works the exact same way, and allows me to get rid of the statement for ignoring pos setpoint generated velocity if SETPOINT_TYPE_VELOCITY is the setpoint type.\n",
          "type": "issue_comment"
        },
        {
          "author": "catch-twenty-two",
          "created_at": "2016-03-22T19:40:20Z",
          "body": "@liang-tang I took some time to make the code more robust and readable overall.  It should address all of your concerns. Were you able to fly it at all?\n",
          "type": "issue_comment"
        },
        {
          "author": "liang-tang",
          "created_at": "2016-03-23T00:55:08Z",
          "body": "@catch-twenty-two I tested many times, i found it difficult to catch up with me, maybe gps data lost?\n",
          "type": "issue_comment"
        },
        {
          "author": "catch-twenty-two",
          "created_at": "2016-03-23T02:42:23Z",
          "body": "@liang-tang Great thanks for testing... Yes, that might be the case, the 3dr radio interferes with my phone gps...  I have to hold it very far away from the phone to get it to work correctly...Once it works though it works well...I'm going to play around with it some more to find the optimal placement for the radio. My friend and  I were able to take turns riding our bikes while having it follow us.  We stopped and started abruptly and also looped back on ourselves over a fairly large parking lot and it stayed with in 5-10 meters of us the whole time. \n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-23T19:42:53Z",
          "body": "Replaced by https://github.com/PX4/Firmware/pull/4065/files\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [
        {
          "author": "catch-twenty-two",
          "created_at": "2016-03-12T22:17:22Z",
          "body": "Don't require a home position\n",
          "path": "src/modules/commander/state_machine_helper.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-19T14:33:46Z",
          "body": "In the section below are changes which exceed the changes needed for follow-me. Either this is a bad merge or the conditioning is incorrect (they should be guarded by if == FOLLOW_TARGET).\n",
          "path": "src/modules/mc_pos_control/mc_pos_control_main.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "catch-twenty-two",
          "created_at": "2016-03-19T15:57:50Z",
          "body": "The above code uses a combination of overriding the velocity set point when it is appropriate while still using the position set point when it's not so I can take advantage of the velocity braking code as the position set point error delta gets smaller.  The code below overrides the velocity set point at all times and ignores the position set point for when the follow target module is in velocity tracking mode.  I was going to make a new set point type for the code below but saw that the position set point type already defined a set point type for velocity only, it just wasn't being used in the code anywhere. I used both of these set point types for a smooth transition between following using position and the velocity only tracking mode. Let me know if you still think I need to fix something or possibly have a better idea for what I am trying to accomplish.\n\nHere is where I switch between the 2 tracking methods:\n\nhttps://github.com/PX4/Firmware/pull/3814/files?diff=unified#diff-35e82494becdfdcc5afaafb5b3f4e361R278\n",
          "path": "src/modules/mc_pos_control/mc_pos_control_main.cpp",
          "position": 1,
          "type": "review_comment"
        }
      ],
      "reviews": []
    }
  },
  {
    "title": "Yaw timeout for VTOL forwards transition",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3740",
    "number": 3740,
    "created_at": "2016-02-12T15:18:46Z",
    "merged": true,
    "merged_at": "2016-02-16T06:51:23Z",
    "state": "closed",
    "conversation": {
      "author": "AndreasAntener",
      "body": "This adds a yaw timeout on accepting the waypoint for the VTOL forwards transition because a VTOL might not reach yaw in wind. Fixes #3728\n\nMIS_YAW_TMT\n- default: -1\n- > 0: timeout active on waypoints which force heading, ignore heading for acceptance on normal waypoints\n\nMIS_YAW_TMT set to 10 seconds for default VTOL configurations\n",
      "issue_comments": [
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-13T00:25:33Z",
          "body": "@LorenzMeier @sanderux timeout and forcing the heading for a transition added. How does this look?\n\nAlready flew the timeout in real, new is the mission failsafe. If this is how we want it for the moment we can merge I think.\n",
          "type": "issue_comment"
        },
        {
          "author": "julianoes",
          "created_at": "2016-02-13T09:00:44Z",
          "body": "Reviewed, seems good other than the comment.\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-13T09:11:33Z",
          "body": "Thanks @julianoes , I will push an update in a sec that also takes care of setting the failure state properly.\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-15T12:54:51Z",
          "body": "Rebased on master\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-15T14:37:37Z",
          "body": "Just found one thing missing here, need to do one more commit.\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-15T18:28:27Z",
          "body": "Anybody knows why px4-stm32f4discovery_default fails on Travis?\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-16T06:52:50Z",
          "body": "Merged after SITL tests. @sanderux this will simplify testing this afternoon. Roman and I will rebase the TECS init, and also get the Kangaroo in before you go testing.\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [
        {
          "author": "julianoes",
          "created_at": "2016-02-13T08:58:29Z",
          "body": "Why -FLT_EPSILON? Shouldn't it be +FLT_EPSILON?\n\nAlso, please comment! How is a reader supposed to grasp what you're trying to achieve with this if...\n",
          "path": "src/modules/navigator/mission_block.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "julianoes",
          "created_at": "2016-02-13T08:59:47Z",
          "body": "Oh, I understand from reading the parameter. A timeout of 0 means, just continue.\nAs I said, please comment!\n",
          "path": "src/modules/navigator/mission_block.cpp",
          "position": 1,
          "type": "review_comment"
        }
      ],
      "reviews": []
    }
  },
  {
    "title": "Vtol weathervane cleaned up history",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3736",
    "number": 3736,
    "created_at": "2016-02-12T11:42:50Z",
    "merged": true,
    "merged_at": "2016-02-15T08:50:32Z",
    "state": "closed",
    "conversation": {
      "author": "RomanBapst",
      "body": "Fixes https://github.com/PX4/Firmware/issues/3679\n@sanderux As discussed I cleaned up the history so that we only remain with three commits.\nThe diff to the old branch is zero so everything should be inside. Will give this a test in SITL and Ada can maybe test fly it today.\n@AndreasAntener  FYI\n",
      "issue_comments": [
        {
          "author": "RomanBapst",
          "created_at": "2016-02-12T11:45:12Z",
          "body": "Please delete the old branch (referenced above ) if there aren't any objections.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-12T11:49:51Z",
          "body": "Done, looks good\n",
          "type": "issue_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2016-02-12T14:54:08Z",
          "body": "@sanderux @AndreasAntener This is flight tested in SITL for both landing and loiter modes. Checked the log files, it seems to do the right thing.\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-12T14:56:15Z",
          "body": "Rain just stopped me right after flashing this branch... I hope the weather is good for you Sander tomorrow :)\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-12T14:58:01Z",
          "body": "There is some wind but that would be the point for this pr. Should stay dry\n",
          "type": "issue_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2016-02-12T15:06:42Z",
          "body": "@sanderux @AndreasAntener Parameters to activate this are\nVT_WV_LND_EN enable mode for landing waypoint\nVT_WV_LTR_EN enable mode for loiter items\nVT_WV_YAWR_SCL scale factor for desired yaw_rate setpoint\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-12T15:10:21Z",
          "body": "VT_WV_LTR_EN doesn't seem to be used anywhere\n",
          "type": "issue_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2016-02-12T15:17:06Z",
          "body": "@AndreasAntener https://github.com/PX4/Firmware/blob/vtol_weather_vane/src/modules/navigator/mission_block.cpp#L75\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-12T15:18:09Z",
          "body": "In mission block\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-12T15:25:00Z",
          "body": "Funny, QGC didn't show me this on the field, anyway, it's there :) \n",
          "type": "issue_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2016-02-12T15:35:46Z",
          "body": "@AndreasAntener I pushed a late fix, probably you didn't have that one.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-14T13:30:38Z",
          "body": "Log from weathervane loiter test: http://logs.uaventure.com/view/t7a2AZB3WHgRZsDjGCEJpi\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-14T14:12:52Z",
          "body": "This looks good. Let's address my 2 comments. We should check it on landing as well even though I don't think it's problematic.\n<img width=\"1366\" alt=\"screen shot 2016-02-14 at 15 07 12\" src=\"https://cloud.githubusercontent.com/assets/5750020/13034114/d95b8a0e-d32c-11e5-817b-5842bf44f54d.png\">\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-14T14:37:08Z",
          "body": "Addressed comment 1\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-14T22:53:17Z",
          "body": "This should address the feed forward\n",
          "type": "issue_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2016-02-15T08:50:41Z",
          "body": "Merged!\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-13T10:11:32Z",
          "body": "we should change `_mode_auto` to `!_control_mode.flag_control_manual_enabled` so this also works in offboard and it's consistent with the other checks\n",
          "path": "src/modules/mc_pos_control/mc_pos_control_main.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-14T13:53:11Z",
          "body": "@tumbili should we also remove the feed forward when we clamp the rate?\n",
          "path": "src/modules/mc_att_control/mc_att_control_main.cpp",
          "position": 72,
          "type": "review_comment"
        }
      ],
      "reviews": []
    }
  },
  {
    "title": "Fix for transition failsafe",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3730",
    "number": 3730,
    "created_at": "2016-02-11T22:40:16Z",
    "merged": true,
    "merged_at": "2016-02-11T23:24:48Z",
    "state": "closed",
    "conversation": {
      "author": "sanderux",
      "body": "fixes https://github.com/PX4/Firmware/issues/3729\nonly transition to MC when not MC\n",
      "issue_comments": [
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-11T23:24:58Z",
          "body": "Great, thanks!\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "Mission takeoff yaw fix",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3724",
    "number": 3724,
    "created_at": "2016-02-11T14:58:14Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "AndreasAntener",
      "body": "Fixes yaw on takeoff over home location\nIncludes #3717\nIncreases stack for mc pos and fw pos controllers\n\nTest flown\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-11T15:02:58Z",
          "body": "Ok, will merge once the build passes.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-11T15:54:46Z",
          "body": "Done, on master, awesome! Thanks!\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "WIP: VTOL weathervane",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3706",
    "number": 3706,
    "created_at": "2016-02-09T01:37:03Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "sanderux",
      "body": "Fixes https://github.com/PX4/Firmware/issues/3679\ncherry-picked all commits onto new branch\n\nTo enable weathervane mode set param VT_OPT_WV_LND to 1\nThe VT_OPT_WV_RATE_D param defines the yaw dampening during landing\n\ntodo:\n- [x] Rename param to vtol_wv_yawrate_scale\n- [x] Disable MC_YAWRATE_I when weathervaning\n- [x] Add option to weathervane in loiter\n- [ ] Implement weathervane strategy when yaw is over-demanded during MC auto flight\n- [ ] flight test\n",
      "issue_comments": [
        {
          "author": "RomanBapst",
          "created_at": "2016-02-10T13:54:40Z",
          "body": "@sanderux I fixed the naming. I guess you need to flight test this now.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-10T14:11:47Z",
          "body": "Thanks, i have a flight window saturday (as it is predicted now).\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-10T14:50:43Z",
          "body": "Looking forward to the testing. I think we should try to de-risk branches in SITL before and turn them into 2-3 test branches so the flight testing becomes tractable.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-11T14:22:01Z",
          "body": "@tumbili where did your commit go renaming the scale param?\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-11T19:24:53Z",
          "body": "@AndreasAntener @sanderux sounds like we need this now to fix #3728. So should probably focus on this.\n",
          "type": "issue_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2016-02-12T08:23:07Z",
          "body": "@sanderux Seems like somebody forced pushed to this branch. I will need to push again from my private laptop.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-12T08:25:27Z",
          "body": "A force push would be visible in the timeline. Rather looks like they were not pushed at all, or to a different branch.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-12T08:26:21Z",
          "body": "@tumbili Since the commits are trivial please just quickly re-do them. Don't wait for tonight, as we miss a test window for @AndreasAntener. I want this to move faster now that you're back.\n",
          "type": "issue_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2016-02-12T11:43:16Z",
          "body": "Closing in favour of #3736\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [
        {
          "author": "RomanBapst",
          "created_at": "2016-02-09T10:41:35Z",
          "body": "@sanderux you can zero the third component of the rates integral here.\n",
          "path": "src/modules/mc_att_control/mc_att_control_main.cpp",
          "position": 53,
          "type": "review_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2016-02-09T10:43:57Z",
          "body": "@sanderux how about changing the name to vtol_wv_yawrate__max? It's not really damping anyway.\n",
          "path": "src/modules/mc_att_control/mc_att_control_main.cpp",
          "position": 4,
          "type": "review_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-11T20:03:51Z",
          "body": "We should add this to is_reached() in the mission if the command is a normal waypoint and a 1-2 second timeout occurred.\n",
          "path": "src/modules/navigator/mission_block.cpp",
          "position": 31,
          "type": "review_comment"
        }
      ],
      "reviews": []
    }
  },
  {
    "title": "WIP: VTOL_TAKEOFF and VTOL_LAND mission command support",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3699",
    "number": 3699,
    "created_at": "2016-02-07T23:47:48Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "sanderux",
      "body": "Fixes: https://github.com/PX4/Firmware/issues/3492\nFixes: https://github.com/PX4/Firmware/issues/3414\nSupport for MAV_CMD_NAV_VTOL_TAKEOFF and MAV_CMD_NAV_VTOL_LAND\n\ntodo\n- [ ] Rebase and remove weathervane merge (maybe setup new branch)\n- [ ] Implement weathervane land for VTOL_LAND\n- [ ] Flight test\n",
      "issue_comments": [
        {
          "author": "sanderux",
          "created_at": "2016-02-07T23:50:57Z",
          "body": "@DonLakeFlyer these commands should be supported in QGC\nthey are in every sense similar to takeoff and land commands\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-07T23:55:24Z",
          "body": "Here's the test mission waypoint file\n[vtol takeoff and land.txt](https://github.com/PX4/Firmware/files/120995/vtol.takeoff.and.land.txt)\n\nThe vtol transition takeoff and land waypoints are displayed as mission frame commands. they are actually located near home. Takeoff a few meters north and land very close to home (where it lands)\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-08T18:08:08Z",
          "body": "whoops, merge was not intended\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-08T20:09:12Z",
          "body": "It's probably best to wait with this until the new mission handling is in (it's ready now, just needs a last flight test).\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-08T21:22:19Z",
          "body": "I'm going to reset this branch. @sanderux Please delete this branch locally and re-checkout it.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-08T21:22:58Z",
          "body": "No, actually not resetting. We'll deal with this later.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-08T22:06:49Z",
          "body": "Both these items need further testing in actual flight (mostly weathervane) because testing this in SITL is hard.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-08T22:10:38Z",
          "body": "@AndreasAntener i merged this code in your vtol_mission_fixes tree locally. works (much better).\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "Vtol weathervane",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3694",
    "number": 3694,
    "created_at": "2016-02-07T12:58:03Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "RomanBapst",
      "body": "Fixes: https://github.com/PX4/Firmware/issues/3679\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-07T14:18:59Z",
          "body": "After reviewing this further, I believe we should clamp the yaw control demand, instead of disabling it completely. So that the system does only spend a little effort in maintaining heading. In light wind it will then maintain it, in heavy wind it will weather-vane.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-07T15:43:10Z",
          "body": "@LorenzMeier i agree, now it might be hard to understand what is going on in low wind conditions. How, and with what threshold should it disable control?\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-07T15:52:59Z",
          "body": "10-20% of the maximum yaw demand might make sense, that would be 0.1-0.2 (you have to limit -0.2..0.2, since its symmetric around zero). That matches the intent to not give up too much control over roll and pitch for yaw.\n",
          "type": "issue_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2016-02-07T16:49:33Z",
          "body": "@LorenzMeier @sanderux I need to check the mixer if this would even make any sense. I believe yaw is mixed in at the very end so that it doesn't violate thrust, roll, pitch\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-07T16:52:34Z",
          "body": "@tumbili This discussion is not about yaw handling. Its about orienting the plane into the wind so that wind gusts do not completely ruin the position and attitude control response. Its very different from mixer limits.\n\nWe reserved a minimum for yaw. And it would put the motors at their maximum spread. It would mean that you would see the system constantly yaw in wind, coupled with roll and pitch. Two motors would run at their maximum capacity and overheat. We can't handle this on a best-effort basis in the mixer. We need to do this in the controller already, like Sander proposed.\n",
          "type": "issue_comment"
        },
        {
          "author": "tubeme",
          "created_at": "2016-02-07T19:32:42Z",
          "body": "This will apply only to QuadPlanes (classic plane with tail and rudder) not the quad delta wings, right? \n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-07T20:14:26Z",
          "body": "@tubeme \nIt will apply to all VTOL types where the setting is enabled. if you have a standard vtol on delta wing i would suggest leaving the VT_OPT_WV_LND set to 0 (default).\n",
          "type": "issue_comment"
        },
        {
          "author": "tubeme",
          "created_at": "2016-02-07T20:56:53Z",
          "body": "@sanderux OK I understand. Thanks.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-07T21:20:11Z",
          "body": "@LorenzMeier is this more what you had in mind?\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-09T01:37:37Z",
          "body": "Replaced by https://github.com/PX4/Firmware/pull/3706\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [
        {
          "author": "RomanBapst",
          "created_at": "2016-02-07T12:59:09Z",
          "body": "@sanderux Make sure to condition this on auto mode!\n",
          "path": "src/modules/mc_pos_control/mc_pos_control_main.cpp",
          "position": 37,
          "type": "review_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-07T13:24:26Z",
          "body": "whitespace error\n",
          "path": "src/modules/navigator/mission_block.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-07T13:28:22Z",
          "body": "We probably need to add the ability to add only ORB_IDs. This fix won't work properly because now the length of the struct is not necessarily equal.\n",
          "path": "src/modules/vtol_att_control/vtol_att_control_main.h",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-07T14:13:51Z",
          "body": "Add the condition here: `!_control_mode.flag_control_manual_enabled &&` then you should be safe.\n",
          "path": "src/modules/mc_pos_control/mc_pos_control_main.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-07T14:15:46Z",
          "body": "This is not the right way to do this. You can get into an increasing yaw rate this way. A simple wind gust would be sufficient to start the spiral of death. What you should do instead is to clamp the actuator control output for yaw.\n",
          "path": "src/modules/mc_att_control/mc_att_control_main.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-07T14:16:44Z",
          "body": "It will look funny if the system is constantly yawing on land. It should instead be \"soft yaw control\" or something like that.\n",
          "path": "src/modules/navigator/mission_block.cpp",
          "position": 1,
          "type": "review_comment"
        }
      ],
      "reviews": []
    }
  },
  {
    "title": "Remove run-once procedure on check_dist_1wp",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3690",
    "number": 3690,
    "created_at": "2016-02-07T00:40:51Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "sanderux",
      "body": "Fixes: https://github.com/PX4/Firmware/issues/3688\n\nThe stored mission is checked at system startup. When no mission is loaded the check returns OK and sets a param that it does not need to check again. When a new mission is uploaded this bool is not reset.\n\nIn light of future adjustments to the feasibility checker (soft check on load, hard check on execute) i have chosen to remove the run-once procedure. I will soon add the ability to load a mission on a location far from the first waypoint, it will warn the user but still accept the mission. Upon execution it will run the check again and fail to execute if still too far away.\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-07T16:56:24Z",
          "body": "Thanks! Cherry-picked to master.\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "Vtol RTL transition before landing when in fixed wing",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3687",
    "number": 3687,
    "created_at": "2016-02-06T22:30:54Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "sanderux",
      "body": "Fixes: https://github.com/PX4/Firmware/issues/3617\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-07T16:39:01Z",
          "body": "Is this SITL tested?\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-07T17:16:07Z",
          "body": "Yes works well in sitl. You can switch a mission during fw flight to rtl, it will transition before landing\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-07T17:20:01Z",
          "body": "Applied to master as its nicely self-contained.\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "use system specific acceptance radius for multirotor takeoff",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3686",
    "number": 3686,
    "created_at": "2016-02-06T20:40:25Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "AndreasAntener",
      "body": "Fixes #3684 \n\nThe condition for reaching takeoff waypoint is the same as on my mission update. Also had to update the isolated takeoff item altitude because the acceptance radius won't be used anymore. Tested in sitl/hil\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-07T00:48:40Z",
          "body": "The root cause of the issue for me seems to be that all acceptance radii are zero. So this PR fixes takeoff, but not the other waypoints.\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-07T09:24:02Z",
          "body": "In SITL they are/were NAN for some reason. If they were zero it would work as it is.\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-07T09:32:30Z",
          "body": "This fix does only use the system acceptance radius for takeoff like we want it anyway, and by chance is also a workaround for sitl issue.\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-07T11:33:34Z",
          "body": "Applied on master\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "WIP: Vtol TECS fix",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3678",
    "number": 3678,
    "created_at": "2016-02-05T18:29:34Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "AndreasAntener",
      "body": "@tumbili new tecs fix branch off master\n",
      "issue_comments": [
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-11T12:26:41Z",
          "body": "With this branch, the desired airspeed is nicely ramped up after the transition. I did 2 flights in altitude control (which is btw awesome to fly the standard VTOL in):\n\n![tecs init flight 1](https://cloud.githubusercontent.com/assets/5750020/12976174/774bc7dc-d0c2-11e5-960b-883c1389e2d1.png)\nhttp://logs.uaventure.com/view/ArZvMEN93W9uMHHU4igTed\n\n![tecs init flight 2](https://cloud.githubusercontent.com/assets/5750020/12976178/79492282-d0c2-11e5-8479-0058136969e1.png)\nhttp://logs.uaventure.com/view/zrRkhmi35oGRRZiq9fTcPm\n\nIn flight 1 you still see that TECS has a huge pitch integrator to start with. There must be something wrong there when TECS starts. In the following transitions and in flight 2 you never see any integrator when it starts, so I'm assuming it's correctly reset.\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-12T08:17:45Z",
          "body": "Another log from yesterday afternoon where the init was ok: http://logs.uaventure.com/view/Gi8kX8ho4oaye8gcjjS5sd\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-12T08:21:19Z",
          "body": "Are you saying we should merge?\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-12T08:28:06Z",
          "body": "No :) This should be flight tested a bit more, also I need to fix AUX logging so I see FW thrust during the transition which is also one of the reasons for this fix.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-12T08:28:44Z",
          "body": "Aux logging is fixed on master (as far as implemented).\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-12T15:01:10Z",
          "body": "Two more flights:\nmission http://logs.uaventure.com/view/gVUinykcLifN6tCpvTTrW6\naltctl http://logs.uaventure.com/view/943VqsD7bbhZq5hX9vzCUf\nnot analyzed yet\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-12T17:12:36Z",
          "body": "Looked good in both flights:\n![screen shot 2016-02-12 at 18 04 01](https://cloud.githubusercontent.com/assets/5750020/13014311/731ff268-d1b3-11e5-8b07-9094368b3d05.png)\n\nVTOL att contorller is holding thrust until tecs/fw pos is publishing, TECS is reinitialized and airspeed setpoint ramps up. The only thing I don't like now is the thrust dip after the transition, could also still be smoothed out.\n\n@tumbili I implemented the thrust holding for standard vtol, how does it look for tailsitter and tiltrotor?\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-12T22:25:13Z",
          "body": "TODOs\n- implement wait_on_fw for tailsitter and tiltrotor\n- copy MC state until finished waiting so the attitude setpoint doesn't jump to an undefined value\n\nFlight test\n- try setting a higher transition speed, e.g. min speed + 1\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-15T00:22:43Z",
          "body": "@tumbili I made the FW position controller aware of when TECS is running and using a 0 pitch and thrust setpoint if not. The irregularity we had before was due to stale TECS data published before it started to run (and reset) again.\n",
          "type": "issue_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2016-02-15T07:45:30Z",
          "body": "@AndreasAntener I had a look and it looks good to me. Looking forward to some flight results.\nEspecially, for the planes of Marco and Sanders I hope to see some difference. They were always diving quite a bit.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-15T13:18:14Z",
          "body": "I think i can fly this tomorrow\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-16T15:16:36Z",
          "body": "2 logs of successful missions and one with induced rc loss failsafe RTL;\nRTL mission 1: http://logs.uaventure.com/view/3msrKYiSjKrDvKKckveA4e\nFull mission 2: http://logs.uaventure.com/view/7y4hdAoz4Bsog8K24qE67c\nFull mission 3: http://logs.uaventure.com/view/x7RvfZX3MVfCrnVgocbUoG\nMission 3 video: https://drive.google.com/file/d/0B27AvDmVit4KQzNNZGRxZ0RaU2M/view?usp=sharing\n\nFor reference here a manual hover log with one yaw turn:\nhttp://logs.uaventure.com/view/YXLzTNbzjasnmqnaQfjMBY \n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-16T15:39:20Z",
          "body": "Wobbly back transition, see missions 2 and 3. and video at 4:27\nThe wobble wasnt there in the transition that happened when switching to manual mode in mission 1\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-16T15:51:00Z",
          "body": "Mission flight on master (without this branch): http://logs.uaventure.com/view/57bJPThtDayp6ZXCQ2guTQ\nmission: http://logs.uaventure.com/view/GanJap84VKsX4scBe7Zk5C\naltctl: http://logs.uaventure.com/view/vY8d5Hdufkwip8gCobdqEL\nabort after transition because it got blown away by wind: http://logs.uaventure.com/view/zQ5WKTyQcqPMJdhLHBD6Zg\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-16T20:01:41Z",
          "body": "After changing some parameters MUCH better performance:\nnew mission 1: http://logs.uaventure.com/view/zCiXVJtTPNoPNZ7e2cn4h\nnew mission 2: http://logs.uaventure.com/view/SGutTXNPo92waZE5UBkGSK\n\nAnd a video of mission 1: https://drive.google.com/file/d/0B27AvDmVit4KT1BpNTRnNzVrZEE/view?usp=sharing\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-16T21:03:36Z",
          "body": "The 2 missions with new params were identical.\nI do see strange altitude behavior when comparing both:\n\nThe whole mission was set on 25m altitude waypoints\n(Alt \\* 100)\n\nMission 1:\n![alt 1](https://cloud.githubusercontent.com/assets/14801663/13090946/1157dbba-d4f9-11e5-8dcc-23900b049b1b.png)\n\nMission 2:\n![alt 2](https://cloud.githubusercontent.com/assets/14801663/13090951/16fe7146-d4f9-11e5-864d-8eaacc407911.png)\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-17T15:39:32Z",
          "body": "New test flights, in 0 wind, higher transition speed, and 0 speed weight:\nhttp://logs.uaventure.com/view/2AZKfJ5DHxbAmbbmsg4dr8\nhttp://logs.uaventure.com/view/qjFVbGSC4ACEzeCN3UcMRB\nvery nice\n",
          "type": "issue_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2016-02-18T10:35:29Z",
          "body": "@AndreasAntener This is tested with tailsitter in SITL.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-18T17:54:24Z",
          "body": "@AndreasAntener Can we merge this?\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-18T17:56:58Z",
          "body": "Awesome work! Rebased and applied (and I checked that I had Roman's rebased branch and the diff is clean).\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "Simulation lockstep",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3675",
    "number": 3675,
    "created_at": "2016-02-04T23:56:36Z",
    "merged": true,
    "merged_at": "2016-02-05T15:52:05Z",
    "state": "closed",
    "conversation": {
      "author": "LorenzMeier",
      "body": "This PR implements the Simulator -> SITL direction and blocks the execution of SITL if the simulator is lagging. It also does time bookkeeping and ensures the blocked execution does not lead to jumping timestamps. \"Flight tested\" in Sim, leads to a lot more stability.\n\n@liamstask @tumbili You probably will enjoy this.\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-04T23:58:03Z",
          "body": "@vbuskirk @darknight-007 This should fix your cloud environment.\n",
          "type": "issue_comment"
        },
        {
          "author": "liamstask",
          "created_at": "2016-02-05T00:01:03Z",
          "body": "nice, checking this out now\n",
          "type": "issue_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2016-02-05T08:26:27Z",
          "body": "@LorenzMeier Great, this is fantastic!\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-05T08:44:01Z",
          "body": "@tumbili could you help with the code review so we can get it in?\n",
          "type": "issue_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2016-02-05T09:00:23Z",
          "body": "@LorenzMeier Yes, will do!\n",
          "type": "issue_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2016-02-05T09:46:50Z",
          "body": "@LorenzMeier Works perfectly fine for me! Will do a review now.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-05T15:52:18Z",
          "body": "Merged after more testing and review.\n",
          "type": "issue_comment"
        },
        {
          "author": "i-sheremet",
          "created_at": "2016-02-06T12:25:48Z",
          "body": "@LorenzMeier Thank you for working on it!\nI have already made a [post](https://groups.google.com/forum/#!topic/px4users/O3r9kFyVT4Y) regarding the issue and my PC setup (_Asus ux32vd : Intel i7 3517U Processor x4_cores, 10 Gb RAM, SSD memory, discrete video card - Nvidia GT 620M_), but unfortunately I didn't notice any significant difference in performance with this corrections. Here are the results I got:\n\nFlight with default setup, gzclient on, shuttling between waypoints 2-3-4. [Flight log](https://drive.google.com/file/d/0B9wE0Um8rdPgc0duUTd0aW1mWE0/view?usp=sharing)\n![1](https://cloud.githubusercontent.com/assets/7020958/12866583/7363e1e4-ccdb-11e5-9415-f1780acf04af.png)\n![2](https://cloud.githubusercontent.com/assets/7020958/12866595/f77c5e84-ccdb-11e5-9f23-1afaac3c6c97.png)\nnutshell constantly prints messages as these:\n\n```\nINFO  simulator is slow. Delay added: 17398 us\nINFO  simulator is slow. Delay added: 13763 us\nINFO  simulator is slow. Delay added: 13225 us\nINFO  simulator is slow. Delay added: 10039 us\nINFO  simulator is slow. Delay added: 11732 us\nINFO  simulator is slow. Delay added: 23303 us\nINFO  simulator is slow. Delay added: 12116 us\nINFO  simulator is slow. Delay added: 11689 us\nINFO  simulator is slow. Delay added: 20377 us\n```\n\nThe exact flight with gzclient off. It made several circles, path is overlapped. [Flight log](https://drive.google.com/file/d/0B9wE0Um8rdPgbXFnREplSHVlLXM/view?usp=sharing)\n![3](https://cloud.githubusercontent.com/assets/7020958/12866610/aa20a662-ccdc-11e5-9a05-d24a9086d4b0.png)\n![4](https://cloud.githubusercontent.com/assets/7020958/12866617/1a1cdcb0-ccdd-11e5-984b-b8f2f4456bc9.png)\nonly 3 messages in nutshell:\n\n```\nINFO  simulator is slow. Delay added: 17390 us\nINFO  simulator is slow. Delay added: 13690 us\nINFO  simulator is slow. Delay added: 14090 us\n```\n\nSo the problem remains. Maybe it has something to do with my gazebo or pc setup? I have gazebo version 6.5.1\nThanks!\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "Mission feasibility fixes",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3673",
    "number": 3673,
    "created_at": "2016-02-04T19:48:57Z",
    "merged": true,
    "merged_at": "2016-02-04T20:36:52Z",
    "state": "closed",
    "conversation": {
      "author": "sanderux",
      "body": "- Fixes https://github.com/PX4/Firmware/issues/3656\n- Fixes https://github.com/PX4/Firmware/issues/3648\n- Corrected spelling on method\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-04T19:58:19Z",
          "body": "Looking good! Will merge once they pass.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-04T20:37:02Z",
          "body": "Merged, thanks!\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "VTOL: check mission feasibility as rotary wing",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3664",
    "number": 3664,
    "created_at": "2016-02-03T21:15:16Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "sanderux",
      "body": "VTOL mission feasibility can be validated on rotary wing basis so no fixed wing landing feasibility will fail the mission\n",
      "issue_comments": [
        {
          "author": "RomanBapst",
          "created_at": "2016-02-06T09:28:36Z",
          "body": "@sanderux Did you test this! If yes I will rebase and merge, looks good.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-06T09:43:21Z",
          "body": "Yes, tested and works. I should note that it does now allow a mission where fw flight flies at very low altitudes when vtol\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-18T17:56:48Z",
          "body": "@tumbili Roman I think we can pull this in. Need to think about further mission check strategies for vtol\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-18T20:42:49Z",
          "body": "Cherry-picked.\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "Mavlink read back frame fix",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3660",
    "number": 3660,
    "created_at": "2016-02-03T10:56:08Z",
    "merged": true,
    "merged_at": "2016-02-03T12:09:06Z",
    "state": "closed",
    "conversation": {
      "author": "sanderux",
      "body": "Fixes https://github.com/PX4/Firmware/issues/3658\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-03T11:24:18Z",
          "body": "Nice! Will merge once it passes.\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "RTL was broken by a recent change, revert",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3604",
    "number": 3604,
    "created_at": "2016-01-26T14:56:37Z",
    "merged": true,
    "merged_at": "2016-01-27T11:05:59Z",
    "state": "closed",
    "conversation": {
      "author": "AndreasAntener",
      "body": "@tumbili can you quickly verify the revert and pull this?\n\nI'm going to reimplement this in https://github.com/PX4/Firmware/pull/3598\n",
      "issue_comments": [
        {
          "author": "AndreasAntener",
          "created_at": "2016-01-26T14:59:02Z",
          "body": "log with mission and RTL: http://logs.uaventure.com/view/zKUEwNhZM4Sep6gkDyLZUd\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "VTOL mission item handling",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3598",
    "number": 3598,
    "created_at": "2016-01-26T02:10:05Z",
    "merged": true,
    "merged_at": "2016-02-08T23:11:44Z",
    "state": "closed",
    "conversation": {
      "author": "AndreasAntener",
      "body": "In general this will fix handling for 2 part mission items (takeoff, landing, transitions)\nFixes #3583\nFixes #3581\nFixes #3501\nFixes #3414\n\nShould handle the following cases consistently:\n- [x] transition: yaw into direction of next wp then transition\n- [x] back transition: transition then move to wp\n- [x] back transition yaw issue\n- [x] takeoff: climb then move to wp\n- [x] land: move to wp then descend (fixes #3388)\n- [x] back transition: yaw north when flying south\n",
      "issue_comments": [
        {
          "author": "julianoes",
          "created_at": "2016-01-26T07:05:20Z",
          "body": "@AndreasAntener ready for review?\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-01-26T07:19:39Z",
          "body": "Only conceptual, see the comment here: https://github.com/PX4/Firmware/issues/3583#issuecomment-174783402\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-01-28T08:09:40Z",
          "body": "@sanderux This is now working in STIL. Please take extra care when testing, I haven't thoroughly tested it yet, so please to a SITL test first. Forward transition now aligns towards next waypoint:\n\n<img width=\"819\" alt=\"screen shot 2016-01-28 at 08 57 03\" src=\"https://cloud.githubusercontent.com/assets/5750020/12638564/7e9d981e-c59e-11e5-9974-1bca814a5505.png\">\n\nhttp://logs.uaventure.com/view/iMh8rPQvEyiCWGfNUTtq2C\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-01-28T08:35:13Z",
          "body": "@AndreasAntener mission_block.cpp:195 \nPX4_WARN(\"yaw err: %.3f\", (float)yaw_err);\n\ngives me a compilation error (double to float). disabled it\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-01-28T23:57:44Z",
          "body": "@AndreasAntener I have a commit ready that fixes an IO hog because the mission feasibility checker was constantly running. Now only running before entering a mission. If you give me access i can attach to your PR to save a lot of merging.\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-01-29T06:41:56Z",
          "body": "Nice! Is it independent from this functionality and my changes? If yes we should treat it as such, so it's traceable and documented on a PR.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-01-29T08:50:00Z",
          "body": "On further inspection it seems although it loops it's only executed when a new home position is set. There does seem to be an issue of accepting invalid missions. see https://github.com/PX4/Firmware/issues/3627\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-01-29T16:30:13Z",
          "body": "Quick update, here is the log from our last flight: http://logs.uaventure.com/view/4G7pGXVjfMSttAmqPTCDkP\n\nWe had some issues with loading the mission back from QGC, which messed up the transition waypoints (lost the \"frame\"). So this flight http://logs.uaventure.com/view/BCMa7QKdCMgakcGdKFUSSg is actually also good but there was probably something wrong with the forward transition waypoint.\n\nOne or two more checks with latest QGC would be good and I need to go through the rest of the command handling to make sure nothing got lost during the refactoring.\n\nAnd the fix on the position controller is still to be verified further.\n",
          "type": "issue_comment"
        },
        {
          "author": "julianoes",
          "created_at": "2016-01-29T17:51:05Z",
          "body": "I think the mission feasablity checker needs to run when a mission is uploaded, not just before it gets executed. Otherwise the user doesn't get the feedback in time.\nOr, is this already the case?\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-01-29T18:04:21Z",
          "body": "@julianoes I think both should happen in a different way. I could be loading a mission from home, 10km away from my intended takeoff point. The FC could warn about the location but it should accept the mission. When switching to mission mode it should fail 10km away from the takeoff point. So i think both answers are correct but the feasibility checker should consider it's frame of reference (store or execute)\n\n@AndreasAntener I have a flight window saturday and/or sunday, I will update to the latest QGC. is there anything specific i could test for you?\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-01-30T09:10:44Z",
          "body": "@sanderux Nothing specific. Would be cool to see this branch working for you as well. Still need to find some setpoint irregularities, curious if they show up in one of your logs as well.\n\nOn the feasibility checker, I think it already works like that. Or somewhat at leas. I was able to load a mission indoors (no position lock) and then go out and fly it. Maybe if you already have a lock it doesn't accept it then. Could you check these cases and open an issue for it? And describe how it should work.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-01-31T16:25:55Z",
          "body": "Full autonomous mission flown.\nLog: http://logs.uaventure.com/view/5e9jP3aSS7Y4UaUyfqaYR9\nVideo: https://drive.google.com/open?id=0B27AvDmVit4KRVlpYkFMNVpTLWM\n\nSaturation occurred at back transition, likely because the next waypoint commanded decent and the angle placed the vehicle sideways on fair wind. I don't know why the rotations before land occurred.\n",
          "type": "issue_comment"
        },
        {
          "author": "julianoes",
          "created_at": "2016-01-31T19:37:02Z",
          "body": "I had a quick look through the changes, mostly looking at comments and trying to spot stupid mistakes (without success which is good :smile:)\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-01T07:52:35Z",
          "body": "@AndreasAntener Could you give this another pass? When is the next opportunity to test-fly the final state for you and / or @sanderux? If not today I would prefer to merge as-is to avoid branch drift.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-01T09:16:07Z",
          "body": "Wind conditions will make further testing hard for me this week. I have noticed several irregularities that i can reproduce in sitl. I will create mission files for this and share them with analysis and confirmation of such behavior in actual flight\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-01T10:50:55Z",
          "body": "@julianoes thanks!\n\n@LorenzMeier I cannot test today, but let me correct a few things, also pushing default VTOL acceptance radius to 3m here as it seems that's what hits people currently the most.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-01T19:13:43Z",
          "body": "@AndreasAntener \nWith reference to https://github.com/mavlink/qgroundcontrol/issues/3390 perhaps we could add the info log of the current waypoint as shown here: https://github.com/sanderux/Firmware/commit/c0f0d883eb9f20202708c9ba82ed90cdedcff1ee#diff-9b5a77642a641b107c8f8a966de34acdR821\n\nOr shall i put this in a separate PR after merging this to master? \n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-02T01:25:22Z",
          "body": "@AndreasAntener please review https://github.com/UAVenture/Firmware/pull/2\nthis implements a general failsafe for most corner cases i encountered.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-02T13:15:36Z",
          "body": "Corner case in which the plane continues flight forever.\n\nSITL waypoint file:\n[land-and-then-backtransition.txt](https://github.com/PX4/Firmware/files/113944/land-and-then-backtransition.txt)\n\nThe sequence of mission items may seem unlikely but i will try to motivate my concern.\nA user will experience that the transition command is executed at the start of the next waypoint (it might even seem as if it is executed before this point). The user could therefor attempt what might seem like a shortcut (set land and then transition) to have the plane land in VTOL.\n\nThe current result of this is a plane that continues forward on it's heading until it runs out of power or in to something. \n\nMy suggestion is to have the feasibility checker validate that there will always be a waypoint before a transition command.\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-02T20:18:29Z",
          "body": "I'm just tracking down the yawing issues on takeoff/landing and @sanderux FW fly-away, should have an update soon.\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-02T23:03:08Z",
          "body": "@sanderux didn't yet find the cause of your landing/transition issue. The fixed wing landing already kicks in there.\n\nFixed a bunch of yawing issues, should be good to merge after another flight test.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-03T06:27:24Z",
          "body": "@AndreasAntener I have created a new PR for the front transition timeout (https://github.com/UAVenture/Firmware/pull/3) where i have integrated your and @LorenzMeier 's comments. \n\nThe weather is very unstable but i will try to get some test flights done soon.\n\nAs soon as things have been tested and merged with master i will start work on mission failsafe (RTH) on failed transitions, improved mission navigation feedback and  i could have a look at MAV_CMD_NAV_VTOL_TAKEOFF / LAND support.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-03T09:07:13Z",
          "body": "I updated the task list for 2 more issues. test can be done by flying this mission in sitl: \n[mission south.txt](https://github.com/PX4/Firmware/files/115354/mission.south.txt)\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-03T17:47:27Z",
          "body": "I added the back transition fix. For corner cases regarding missions \"invalid\" missions we should open new issues.\n\n@sanderux could you give this another SITL test with valid missions?\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-03T18:09:28Z",
          "body": "Tested. SITL normal mission looks great, no more unneeded yawing\n",
          "type": "issue_comment"
        },
        {
          "author": "CornerOfSkyline",
          "created_at": "2016-02-05T15:32:47Z",
          "body": "@AndreasAntener \n![2016-02-05 23 34 13](https://cloud.githubusercontent.com/assets/12220448/12850697/077b8ce0-cc61-11e5-96c8-dd385c39d2ea.png)\nI think we should make the velocity commander smooth. When the vtol translate back to the mc, the velocity can not decelerate smaller than the mc max velocity in the several translate back seconds, there will be a huge velocity commander to control the vtol in the mc mode. It cause a big pitch commander and the vtol respond the pitch commander , it looks danger when the vtol translate back.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-05T15:48:43Z",
          "body": "The question is what velocity you commanded - if you command position hold (pitch stick zero) and trigger the velocity you get what you ask for - deceleration with the maximum braking moment. I haven't seen so far anything in real flight or in videos that I would consider extreme.\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-02-05T18:20:06Z",
          "body": "Two flights with the current state:\nhttp://logs.uaventure.com/view/VxcqqMHj6cNiuqXDjcA9C7\nhttp://logs.uaventure.com/view/GiVxcx93DbU3W5jFgXZ6Qc\n\nApart from the last bit they went great, there was a waypoint missing on the mission at the end, the climbing I cannot reproduce in SITL\n\n@CornerOfSkyline yes I see pitching as well. Maybe something changed on master, I have a feeling this was better a while back.\n",
          "type": "issue_comment"
        },
        {
          "author": "CornerOfSkyline",
          "created_at": "2016-02-06T02:14:12Z",
          "body": "@LorenzMeier  I test the VTOL auto mission in the gazebo_sitl , the whole fly is in mission mode. There is no manual control.\n\nHere is the log file.\n\nhttp://logs.uaventure.com/view/YNQ9bgD4XmUwt2srbo6whQ\n\n![2016-02-06 10 21 20](https://cloud.githubusercontent.com/assets/12220448/12864038/73d7e73a-ccbb-11e5-8b7e-8102c3d3933b.png)\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-02-06T09:37:24Z",
          "body": "@andreasantener does your last commit fully replace\nhttps://github.com/PX4/Firmware/pull/3660 ?\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [
        {
          "author": "julianoes",
          "created_at": "2016-01-31T19:21:30Z",
          "body": "Please add a comment for why this condition is how it is. A reader has no clue what's going on here.\n",
          "path": "src/modules/mc_pos_control/mc_pos_control_main.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "julianoes",
          "created_at": "2016-01-31T19:22:10Z",
          "body": "Also, this comment is out of sync because it seems it's not just about AUTO.\n",
          "path": "src/modules/mc_pos_control/mc_pos_control_main.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-01T07:50:39Z",
          "body": "This is not a critical message.\n",
          "path": "src/modules/navigator/mission.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-01T07:50:57Z",
          "body": "This is not a critical message.\n",
          "path": "src/modules/navigator/mission.cpp",
          "position": 1,
          "type": "review_comment"
        }
      ],
      "reviews": []
    }
  },
  {
    "title": "Navigator: Do not update a position setpoint for mission items not enâ€¦",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3582",
    "number": 3582,
    "created_at": "2016-01-24T16:03:27Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "LorenzMeier",
      "body": "â€¦coding positions. Fix for #3581 - or at least a step towards it.\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-01-24T16:04:11Z",
          "body": "@AndreasAntener @tumbili I think you need to do this or more to fix the zero altitude you got. It should at least point you into the right direction.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-01-24T16:27:43Z",
          "body": "@julianoes Please don't comment on commits, but on the diff here. Its non-consumable. This patch set is not complete. Its just a first step.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-01-24T16:28:28Z",
          "body": "What I fixed is the lower-level routine not having any boundary checks. The _real_ fix is to ensure it never gets called on a non-position setpoint!\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-01-24T16:33:25Z",
          "body": "@tumbili @AndreasAntener @julianoes The real fix needs to be applied here: Instead of returning a mission item, this routine needs to return the next action and the next 3D position:\nhttps://github.com/PX4/Firmware/blob/6eac78d67529e20c3170092fd271c11c57c70f2f/src/modules/navigator/mission.cpp#L658-L759\n\nThen the action needs to be handled and the next 3D position is fed into the right mission logic. With that change we always have a next 3D position, no changes to the main waypoint code are required and we just need to slightly change the way commands are published.\n\nThe two PRs I submitted could potentially be left out as well. Please make sure you understand the implications before you continue on this.\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-01-31T14:06:08Z",
          "body": "replaced by #3598\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "VTOL transition command: Wait for transition to complete before switcâ€¦",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3579",
    "number": 3579,
    "created_at": "2016-01-24T13:43:12Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "LorenzMeier",
      "body": "â€¦hing state. This ensures there cannot be a race condition with acceptance radius handling.\n\n@AndreasAntener This is the last needed bit to secure the acceptance radius handling.\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-01-24T16:34:54Z",
          "body": "I think we should rather fix it here:\nhttps://github.com/PX4/Firmware/pull/3582#issuecomment-174314142\n\nAnd remove all command handling from inline mission code.\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-01-31T14:05:54Z",
          "body": "replaced by #3598\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "Reject mission when starting with LAND and vehicle is landed",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3571",
    "number": 3571,
    "created_at": "2016-01-23T16:01:21Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "sanderux",
      "body": "This will reject a mission that starts with a LAND command if the vehicle is not airborn\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-01-23T16:06:08Z",
          "body": "Nice!\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-01-24T10:19:29Z",
          "body": "Applied on master, thanks!\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "Do change speed support",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3567",
    "number": 3567,
    "created_at": "2016-01-22T12:31:43Z",
    "merged": true,
    "merged_at": "2016-03-13T17:12:39Z",
    "state": "closed",
    "conversation": {
      "author": "LorenzMeier",
      "body": "",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-01-22T12:32:28Z",
          "body": "@MikaelFerland  @tubeme This is now implemented, but UNTESTED. Simulation testing would be appreciated. I will get to test it later this weekend.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-07T17:13:43Z",
          "body": "Support is in for QGC. Just needs to be validated here.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-11T10:50:39Z",
          "body": "Doesn't seem to work yet. Not sure why.\n",
          "type": "issue_comment"
        },
        {
          "author": "MikaelFerland",
          "created_at": "2016-02-11T12:51:13Z",
          "body": "Does it take the speed from an average of GPS data or it uses the ground\nspeed sensor as reference? I have tested over HITL with jMAVSim, but I was\nunsuccesful for me also.\n\nDoesn't seem to work yet. Not sure why.\n\nâ€”\nReply to this email directly or view it on GitHub\nhttps://github.com/PX4/Firmware/pull/3567#issuecomment-182807771.\n",
          "type": "issue_comment"
        },
        {
          "author": "tubeme",
          "created_at": "2016-02-16T13:44:10Z",
          "body": "Does not work in mission. Could not load the mission QGC gave error. I'm using the Latest master with the Intel angle patch from couple of days. PX4 master is 5 days old. \n\n![setspeed](https://cloud.githubusercontent.com/assets/12617619/13077856/145353c4-d4c4-11e5-897b-019862457e6f.png)\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-17T15:52:32Z",
          "body": "@tubeme I've tested it after a few additional fixes successfully in SITL. @dagar Could you test with Gazebo / VTOL sim in fixed wing mode? Then it would be ready for flight tests.\n\n<img width=\"1392\" alt=\"screen shot 2016-02-17 at 16 49 19\" src=\"https://cloud.githubusercontent.com/assets/1208119/13115122/d2b8e4f0-d596-11e5-93b9-ed8fee75b986.png\">\n",
          "type": "issue_comment"
        },
        {
          "author": "MikaelFerland",
          "created_at": "2016-02-17T18:06:30Z",
          "body": "@LorenzMeier Did you see my comments? Addionally, do I will be able to test it with jMAVSim or you guys usually tested it with Gazebo? Because it will fix my setup to get better results. Thank you for your time.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-17T18:09:23Z",
          "body": "@MikaelFerland You would need to re-test with the current state I pushed. Its ground speed based for multicopters, currently airspeed based for planes. We'll clean this up for planes later.\n",
          "type": "issue_comment"
        },
        {
          "author": "MikaelFerland",
          "created_at": "2016-02-17T18:14:05Z",
          "body": "Perfect, to simulate it jMAVSim or Gazebo is prefered?\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-17T18:21:24Z",
          "body": "Both works.\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-02-18T05:36:10Z",
          "body": "It seems my old thinkpad is nowhere near fast enough to run the gazebo simulation, so you may have finally given me a reason to upgrade. I'll try it again on a faster machine tomorrow.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-02-18T17:58:25Z",
          "body": "Rebased on master. Needs flight testing. Tested successfully in SITL in multicopter mode.\n",
          "type": "issue_comment"
        },
        {
          "author": "tubeme",
          "created_at": "2016-02-18T21:59:13Z",
          "body": "Do I need the latest master of QGC for this mission or can go with the current version I use from the screenshot?\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-02-19T01:11:21Z",
          "body": "![screenshot from 2016-02-18 20 09 31](https://cloud.githubusercontent.com/assets/84712/13163508/b579da6c-d67b-11e5-9093-381c8c94dcf2.png)\n\nI'm getting airspeed errors in the gazebo simulation now.\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-02-19T01:34:06Z",
          "body": "Rebased on master to get airspeed fix.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-13T17:12:54Z",
          "body": "Merged to master.\n",
          "type": "issue_comment"
        },
        {
          "author": "MikaelFerland",
          "created_at": "2016-03-15T02:29:59Z",
          "body": "@LorenzMeier Thank you, we tested it last weekend, and it works very well. We land unsuccessfully, but I think we broke the power plug before the mission start. We will test it again this sunday of the weather permit us.\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [
        {
          "author": "AndreasAntener",
          "created_at": "2016-03-07T20:00:19Z",
          "body": "Really? ;) I'd say 10 would be the max acceptable default.\n",
          "path": "src/modules/mc_pos_control/mc_pos_control_params.c",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-03-07T20:00:38Z",
          "body": "I guess that should be MPC_XY_CRUISE\n",
          "path": "src/modules/navigator/navigator_main.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-03-07T21:59:06Z",
          "body": "Yes indeed.\n",
          "path": "src/modules/navigator/navigator_main.cpp",
          "position": 1,
          "type": "review_comment"
        }
      ],
      "reviews": []
    }
  },
  {
    "title": "for multicopter landings make sure that the copter moves",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3523",
    "number": 3523,
    "created_at": "2016-01-16T16:29:32Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "RomanBapst",
      "body": "to the landing waypoint first before the descending phase starts\n\nFixes https://github.com/PX4/Firmware/issues/3388\n",
      "issue_comments": [
        {
          "author": "RomanBapst",
          "created_at": "2016-01-16T16:31:28Z",
          "body": "@LorenzMeier @AndreasAntener This makes sure that the copter first moves to the landing waypoint before it starts to descend. For the approach it will use the altitude specified in the landing waypoint.\nI'm not very sure if this is the correct altitude. What is the meaning of the landing waypoint altitude?\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-01-16T16:49:32Z",
          "body": "From a user standpoint i would agree that the altitude in a land command would mean 'go here at this altitude and then land'. 0 altitude could be interpreted as 'keep current altitude'\n",
          "type": "issue_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2016-01-16T17:08:13Z",
          "body": "@sanderux Thanks for your feedback! Makes sense, I can add the logic for the zero case.\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-01-17T09:56:50Z",
          "body": "@sanderux @tumbili We should be careful with special cases that are not clearly documented/specified. It could as well be that 0 is a valid relative landing WP altitude if the target landing point is below home. Because the user always specifies the altitude for a normal WP I would just keep that behaviour consistent as Roman described.\n",
          "type": "issue_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2016-01-17T10:10:15Z",
          "body": "@AndreasAntener Yes, good argument.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-01-17T10:34:06Z",
          "body": "Yes, true. QGC (and most GCS i think) maintain the altitude of the last WP when planning a mission so it should not be needed.\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-01-21T17:36:07Z",
          "body": "Tested and working. But before the yaw setpoint changed back to what it had at home for the landing. We can probably take this because we need to have a look at yawing during missions anyway.\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "multirotor mission feasibility checks:",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3518",
    "number": 3518,
    "created_at": "2016-01-15T11:48:39Z",
    "merged": true,
    "merged_at": "2016-01-17T14:43:53Z",
    "state": "closed",
    "conversation": {
      "author": "RomanBapst",
      "body": "make sure that the relative altitude of the takeoff waypoint is\nat least one meter higher than the acceptance radius of the waypoint.\nThis makes sure that the takeoff waypoint is not reached before the vehicle\nis at least one meter in the air.\n",
      "issue_comments": [
        {
          "author": "RomanBapst",
          "created_at": "2016-01-17T12:10:49Z",
          "body": "@LorenzMeier Fixed\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-01-17T12:12:42Z",
          "body": "Is this tested in SITL? If it passes there I would like to merge it. This is something where SITL provides 100% coverage and I can't see why it would be worse than outdoor tests.\n",
          "type": "issue_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2016-01-17T12:13:37Z",
          "body": "@LorenzMeier Tested in SITL but needs one more test after checks.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-01-17T14:38:41Z",
          "body": "So can we test and merge (locally, not via github) now?\n",
          "type": "issue_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2016-01-17T14:43:48Z",
          "body": "@LorenzMeier Tested it in SITL, works as expected.\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-01-17T11:30:25Z",
          "body": "There is a call to get the default acceptance radius from the navigator. Never use hardcoded numbers.\n",
          "path": "src/modules/navigator/mission_feasibility_checker.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-01-17T11:31:57Z",
          "body": "`get_acceptance_radius();` in class Navigator.\n",
          "path": "src/modules/navigator/mission_feasibility_checker.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-01-17T11:32:35Z",
          "body": "Should say \"Mission rejected: Takeoff altitude too low!\"\n",
          "path": "src/modules/navigator/mission_feasibility_checker.cpp",
          "position": 1,
          "type": "review_comment"
        }
      ],
      "reviews": []
    }
  },
  {
    "title": "Properly handle takeoff waypoint when not currently at takeoff location",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3459",
    "number": 3459,
    "created_at": "2016-01-07T16:01:09Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "AndreasAntener",
      "body": "Fixes #3387 \n\nInstead of taking off like this:\n![screen shot 2016-01-07 at 15 01 38](https://cloud.githubusercontent.com/assets/5750020/12174890/8cb62cd0-b55f-11e5-94e1-05624b7419d4.png)\n\nIt will now do this:\n![screen shot 2016-01-07 at 15 08 12](https://cloud.githubusercontent.com/assets/5750020/12174892/8e6dc330-b55f-11e5-8b6e-1bcc4df9e956.png)\n\nThis should also fix a bug where the \"next\" setpoint kept the type takeoff and just never stopped climbing. Although that one occurred randomly for me and I could never really pin it down.\n\nTested with takeoff WP at current location and away from current location. Fixed-wing should not be affected because the already existing takeoff flag is only set for MC\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-01-07T21:25:34Z",
          "body": "Applied, thanks!\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "VTOL transition helper class",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3426",
    "number": 3426,
    "created_at": "2016-01-03T20:22:51Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "sanderux",
      "body": "A helper class for VTOL transitions.\nNavigator modified to wait until transition has finished before proceding to next waypoint.\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-01-03T23:26:06Z",
          "body": "Nice! @sjwilks @AndreasAntener FYI\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "Cmd forwarding",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/3419",
    "number": 3419,
    "created_at": "2016-01-02T20:21:57Z",
    "merged": true,
    "merged_at": "2016-01-11T07:35:45Z",
    "state": "closed",
    "conversation": {
      "author": "LorenzMeier",
      "body": "@AndreasAntener @sanderux This should be enough to forward the transition command and allow to embed it into missions. It also prepares everything for camera triggers. QGC should get support for all this also today.\n\nNone of this is tested, so bring up carefully. But it shows at least where to put the plumbing.\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-01-02T20:22:20Z",
          "body": "@SimonWilks This goes pretty far in enabling what we discussed.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-01-02T20:35:14Z",
          "body": "You can use this QGC branch: https://github.com/mavlink/qgroundcontrol/pull/2510\n\n<img width=\"1144\" alt=\"screen shot 2016-01-02 at 21 32 28\" src=\"https://cloud.githubusercontent.com/assets/1208119/12076012/b25644d6-b198-11e5-910c-c49f5b46fddd.png\">\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-01-03T13:50:52Z",
          "body": "This is in QGC master and has made it into the daily build.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-01-03T20:26:12Z",
          "body": "PR https://github.com/PX4/Firmware/pull/3426\nUntested but a basis to expand on.\n\nI will field test this asap. If succesful i will add some more logic like failsafe.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-01-05T20:16:58Z",
          "body": "@sanderux Before re-working the whole mission / transition logic, should we maybe test this and try to get this in? It should enable transitions already.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-01-05T23:54:05Z",
          "body": "@LorenzMeier The commands where not picked up by the VTOL controller. The current setup doesn't use the helper classes to perform these tasks in missions. (same with takeoff / land).they are only used for navigation modes.\n\nI have added publishing the command and checking transition completion in the current style for missions. I would be an advocate of rewriting this so that the helper classes are used in missions as well. Currently that would mean changing transition, takeoff and land procedures in the mission_block.\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-01-06T07:54:30Z",
          "body": "@sanderux With helper classes I assume you are referring to the independent nav state handlers (takeoff.cpp, land.cpp etc). I agree that we should try to reuse the handling code, like mission item creation which I already refactored for takeoff/land and RTL (common code in the super class mission_block.cpp). That should go into the direction you mean right?\n\nBut generally these navigation states can be executed standalone and therefore have different entry/exit state handling which we cannot merge. Otherwise we need to think about the general approach there.\n",
          "type": "issue_comment"
        },
        {
          "author": "AndreasAntener",
          "created_at": "2016-01-11T07:33:48Z",
          "body": "I think this can be merged. Just did another test with the rebased version.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-01-11T07:35:47Z",
          "body": "Nice!\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "Break down sensor combined",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4917",
    "number": 4917,
    "created_at": "2016-06-27T06:30:10Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "bkueng",
      "body": "As discussed in https://github.com/PX4/Firmware/issues/4861\n- This reduces the size of `sensor_combined` by a factor of 10 (!) from 790 to 72 bytes.\n- move voting into sensors module. This means that now everyone using `sensor_combined` gets voted data, including ekf2. It also adds voting for the baro.\n- use relative timestamps, necessary for the new logger. Logging `sensor_combined` at full rate now only needs 18KB/s.\n- Memory savings: when using the `q` estimator, we get almost 2kB of additional RAM, with ekf2 it's roughly 0.6kB. This is because ekf2 did not do voting, and voting itself is quite heavy, it requires 1.5kB.\n\nThis introduces a lot of changes at central places, affecting all estimators. Nothing complex, but still, it needs careful review and testing all of the estimators.\n\nI still plan to break up the sensors class into several smaller classes to make things easier to maintain.\n",
      "issue_comments": [
        {
          "author": "bkueng",
          "created_at": "2016-06-28T18:31:59Z",
          "body": "This was flight tested with inav and q estimators.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-07-06T07:31:55Z",
          "body": "@bkueng What is the value of renaming sensor_accel to sensor_accel_raw? Unless there is clear value on top of just naming I would like to avoid that change.\n",
          "type": "issue_comment"
        },
        {
          "author": "bkueng",
          "created_at": "2016-07-06T07:39:50Z",
          "body": "It makes it more clear that it's the raw sensor data from the driver. Initially I planned to split up sensor_combined into several topics which would have gotten the name `sensor_accel` etc. However as sensor_combined is now really small, it's not necessary to split it, so the topic rename is not strictly necessary either.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-07-06T08:01:52Z",
          "body": "I don't think that the rename at this point adds significant clarity and I know that a lot of people are using the topics directly. So I think that's a change we shouldn't make at this point.\n",
          "type": "issue_comment"
        },
        {
          "author": "bkueng",
          "created_at": "2016-07-06T08:18:49Z",
          "body": "Fine with me. I'll drop it when rebasing. Do you plan to merge it now?\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-07-06T08:38:18Z",
          "body": "Yes, I think it makes sense to get these in.\n",
          "type": "issue_comment"
        },
        {
          "author": "bkueng",
          "created_at": "2016-07-06T09:16:23Z",
          "body": "rebased & dropped sensor topics renaming\n",
          "type": "issue_comment"
        },
        {
          "author": "bkueng",
          "created_at": "2016-07-06T13:51:18Z",
          "body": "@julianoes I agree in both cases. I discussed this with @tumbili and he prefered the integral because the estimators use it. But when looking at the overall usage, most places need the value, not the integral. Personally I also prefer the values.\nPlus when thinking about the new logger, the value can be plotted directly.\n",
          "type": "issue_comment"
        },
        {
          "author": "julianoes",
          "created_at": "2016-07-06T14:11:57Z",
          "body": "I like the changes overall but I would vote to change the sensor_combined struct and make the API as simple as possible for devs.\n\nTherefore, I'd publish the accel/gyro/mag values without integral plus timestamp. If an estimator really wants integrals, it should just multiply the values with delta_t. I think this would make it cleaner and also better performance-wise because it would lead to less divisions.\nI'm just not sold on the idea of integrals instead of intuitive values.\n",
          "type": "issue_comment"
        },
        {
          "author": "bkueng",
          "created_at": "2016-07-06T14:18:24Z",
          "body": "just to be clear, you mean like this? sensor_combined.msg:\n\n```\nfloat32[3] gyro_rad\nfloat gyro_integral_dt # in seconds\n\nint32 accelerometer_timestamp_relative\nfloat32[3] accelerometer_m_s\nfloat accelerometer_integral_dt \n\nint32 magnetometer_timestamp_relative\nfloat32[3] magnetometer_ga  \n\nint32 baro_timestamp_relative\nfloat32 baro_alt_meter      \nfloat32 baro_temp_celcius\n```\n",
          "type": "issue_comment"
        },
        {
          "author": "julianoes",
          "created_at": "2016-07-06T14:32:39Z",
          "body": "@bkueng yes that's what I would suggest.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-07-06T14:56:35Z",
          "body": "Looks sensible to me.\n",
          "type": "issue_comment"
        },
        {
          "author": "bkueng",
          "created_at": "2016-07-06T17:04:41Z",
          "body": "ok if no one objects, I'll change this.\n",
          "type": "issue_comment"
        },
        {
          "author": "bkueng",
          "created_at": "2016-07-07T08:54:19Z",
          "body": "refactored to the above format\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-07-07T09:36:17Z",
          "body": "Rebased and applied.\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [
        {
          "author": "julianoes",
          "created_at": "2016-07-06T13:18:08Z",
          "body": "Having to add the division through dt everywhere seems painful. Of course, you've done it already, I'm just thinking of devs that will get confused. Are we sure we want to do this?\n",
          "path": "src/drivers/frsky_telemetry/frsky_data.c",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "julianoes",
          "created_at": "2016-07-06T13:23:46Z",
          "body": "I would argue this should be a `float32` in seconds. I'm not completely happy that you need to do `/ 1.e6f;` everywhere below.\n",
          "path": "msg/sensor_combined.msg",
          "position": 1,
          "type": "review_comment"
        }
      ],
      "reviews": []
    }
  },
  {
    "title": "Stable",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4895",
    "number": 4895,
    "created_at": "2016-06-24T07:13:11Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "idandan0924",
      "body": "",
      "issue_comments": [],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "Fw vtol no airspeed",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4813",
    "number": 4813,
    "created_at": "2016-06-14T08:51:44Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "RomanBapst",
      "body": "",
      "issue_comments": [
        {
          "author": "RomanBapst",
          "created_at": "2016-06-14T08:52:49Z",
          "body": "@sanderux I was looking at it and noticed that with this implementation we will not be blending controls during the transition. Might make sense to blend the controls based on time just like it's done for the backtransition.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-06-15T22:12:04Z",
          "body": "i'll get that in, do you think it's ok to base it on min trans time, or should i add a seperate param?\n",
          "type": "issue_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2016-06-21T08:35:36Z",
          "body": "@sanderux I think min trans time is ok.\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "Implement throttle setting for MAV_CMD_DO_CHANGE_SPEED",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4790",
    "number": 4790,
    "created_at": "2016-06-09T23:19:56Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "sanderux",
      "body": "Fixes https://github.com/PX4/Firmware/issues/4786\n\nThis implements the throttle value of the mission command \"Change speed\"\nAttaching this to the no-airspeed PR as it only has (serious) effect when disabling airspeed sensor\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-06-10T07:03:14Z",
          "body": "@tumbili Can you review? Looks good for me.\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-06-10T15:58:39Z",
          "body": "Have you flown this outside @sanderux? I'm just curious how consistently you actually keep the desired throttle? If the commanded throttle isn't sufficient for the altitude setpoint it's going to be ignored anyway.\nhttps://github.com/PX4/Firmware/blob/master/src/lib/external_lgpl/tecs/tecs.cpp#L312\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-06-10T21:56:51Z",
          "body": "@dagar i havent flown it outside yet. it's true that tecs will balance the throttle with the altitude but there does seem to be a limit to that.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-06-21T08:23:43Z",
          "body": "@sanderux Will merge once flown\n",
          "type": "issue_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2016-06-21T13:10:53Z",
          "body": "@LorenzMeier @sanderux @dagar Did a review and it looks good (did a minor comment on variable naming). So next thing here is a log from a flight test.\n",
          "type": "issue_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2016-06-21T14:04:36Z",
          "body": "@sanderux Personally I think this change will not change much. TECS will adjust its throttle integrator until it's back at the old desired value. You can verify this in SITL by the way.\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-06-21T14:55:29Z",
          "body": "Right, it's the same as just changing FW_THR_CRUISE.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-06-21T19:24:23Z",
          "body": "@tumbili ready to go\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-06-21T19:31:00Z",
          "body": "@dagar applying this will only make sense when airspeed sensor is disabled. at that point tecs will disregard airspeed and only change throttle if required for altitude. This will enable vtol's with no airspeed sensor to decrease speed before backtransition or increase speed when climbing significantly. a typical mission would be:\n- vtol takeoff 20m\n- throttle to 80%\n- climb to 150m\n- throttle to 40%\n- cruise towards destination\n- descend to 20m\n- throttle to 20%\n- vtol_land \n",
          "type": "issue_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2016-06-21T20:59:58Z",
          "body": "Closing in favour of #4770\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [
        {
          "author": "RomanBapst",
          "created_at": "2016-06-21T12:49:13Z",
          "body": "@sanderux Why is the argument called 'percent'? Aren't you passing a throttle value?\n",
          "path": "src/modules/navigator/navigator.h",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-06-21T12:57:27Z",
          "body": "@tumbili no, QGC asks for a percentage. mavlink also specs this: https://pixhawk.ethz.ch/mavlink/#MAV_CMD_DO_CHANGE_SPEED\n\nFW_THR_CRUISE is also a percentage and tecs expects a percentage here\n",
          "path": "src/modules/navigator/navigator.h",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2016-06-21T13:09:42Z",
          "body": "@sanderux Yeah, the mission item holds a throttle percentage but the function 'set_cruising_throttle' takes as argument a throttle value between 0 and 1.\n",
          "path": "src/modules/navigator/navigator.h",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-06-21T13:11:31Z",
          "body": "Ok, shall i just call it throttle, or value then?\n",
          "path": "src/modules/navigator/navigator.h",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2016-06-21T13:12:57Z",
          "body": "@sanderux throttle is good.\n",
          "path": "src/modules/navigator/navigator.h",
          "position": 1,
          "type": "review_comment"
        }
      ],
      "reviews": []
    }
  },
  {
    "title": "Comply with altitude for VTOL_LAND mission item",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4785",
    "number": 4785,
    "created_at": "2016-06-09T09:26:19Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "sanderux",
      "body": "fixes https://github.com/PX4/Firmware/issues/4784\n",
      "issue_comments": [
        {
          "author": "sanderux",
          "created_at": "2016-06-30T20:59:16Z",
          "body": "@LorenzMeier AFAIK ready to merge\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-07-10T10:52:13Z",
          "body": "Doesn't look ready. It changes the logic entirely and it makes assumptions about magic values.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-07-10T10:55:15Z",
          "body": "The magic value is in QGC, it defaults the mission_item altitude to 0.\nBut you're right, it should check if it is different from 0, not just below zero.\nor do you think we should ignore the mission_item's altitude all together?\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-07-23T23:18:53Z",
          "body": "@LorenzMeier i addressed your comment, can you review bearing in mind that QGC defaults the altitude parameter to 0 on a VTOL_LAND command?\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-08-01T06:56:48Z",
          "body": "@LorenzMeier is this ready to merge?\n",
          "type": "issue_comment"
        },
        {
          "author": "PX4BuildBot",
          "created_at": "2016-10-19T19:53:03Z",
          "body": "Can one of the admins verify this patch?\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-10-27T00:10:48Z",
          "body": "It seems like MAV_CMD_NAV_VTOL_LAND needs a separate transition altitude and landing altitude.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-10-27T09:04:00Z",
          "body": "@LorenzMeier can you review this again? (note that stable QGC sets altitude to 0 by default for VTOL_LAND)\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-11-08T03:46:52Z",
          "body": "@sanderux does it make sense now that VTOL_LAND specifies the landing coordinates (lat, lon, alt) just like regular LAND? The QGC default is 0 relative to home. Could we add an additional optional param to VTOL_LAND that also specifics the back transition altitude?\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-11-08T08:27:57Z",
          "body": "I think we need a different discussion on the meaning of altitude in a land command as it does not seem to perform what i would expect.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-12-20T00:53:13Z",
          "body": "closing in favor of changes pending from https://github.com/PX4/Firmware/issues/5824",
          "type": "issue_comment"
        }
      ],
      "review_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-07-10T10:51:46Z",
          "body": "So if I fly at sea level an altitude request of 0 meters will be rejected? This doesn't look completely thought out.\n",
          "path": "src/modules/navigator/mission.cpp",
          "position": 1,
          "type": "review_comment"
        }
      ],
      "reviews": []
    }
  },
  {
    "title": "Enable FW without airspeed sensor",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4770",
    "number": 4770,
    "created_at": "2016-06-08T09:33:06Z",
    "merged": true,
    "merged_at": "2016-06-23T07:28:06Z",
    "state": "closed",
    "conversation": {
      "author": "RomanBapst",
      "body": "Enables flying a fw / vtol without an airspeed sensor.\nThe new mode parameter enables 3 different modes:\n\n1) Use values from airspeed sensor\n2) Approximate airspeed with ground velocity (good if wind-still, e.g indoors with VICON )\n3) Declare airspeed invalid, controllers will assume trim speed (e.g. TECS or fw attitude controller)\n",
      "issue_comments": [
        {
          "author": "RomanBapst",
          "created_at": "2016-06-08T11:14:33Z",
          "body": "Jenkins test this please!\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-06-08T12:51:35Z",
          "body": "Very nice. To enable VTOL transitions without ASPS we need to change the transition logic to consider this param. A new (or existing param) should be used to add a time constant (front transition time).\nAt the moment we have a VT_F_TRANS_DUR (front transition duration) param which in effect is the ramp-up time for the pusher motor. To avoid confusion i propose to rename this to VT_F_TRANS_RAMP and use VT_F_TRANS_TIME as the new constant.\n\nAlternatively we could rely on VT_TRANS_MIN_TM but this will have defaulted to low values by now.\n@tumbili ?\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-06-08T12:54:12Z",
          "body": "SITL flies very well on mode 2 (disable airspeed) (transition still looks at airspeed) but the FW flights holds well even at very low airspeeds. TECS does respond too slow to compensate for stalls when the throttle trim is too low but it nicely balances banking etc.\n",
          "type": "issue_comment"
        },
        {
          "author": "melisab",
          "created_at": "2016-06-08T16:21:26Z",
          "body": "So, in VTOL we need to use ground speed estimation to replace indicated_airspeed_m_s ? \n",
          "type": "issue_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2016-06-08T19:24:46Z",
          "body": "@melisab You certainly don't need to do this and if you have an airspeed sensor available I certainly don't recommend you to do this.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-06-08T21:09:22Z",
          "body": "@tumbili i added initial support for vtol transition based on minimum transition time. Works very nice in sitl. tested a few scenarios, no regression.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-06-08T21:41:50Z",
          "body": "![image](https://cloud.githubusercontent.com/assets/14801663/15911879/ed479cba-2dd1-11e6-871d-36c8bf01022c.png)\n\nNotes on flying VTOL without airspeed sensor:\n- Make sure your FW_THR_CRUISE is set to a sensible level.\n- Set the airspeed sensor circuit braker\n- Set VT_TRANS_MIN_TM higher (this is the time it will take to transition)\n- Set VT_F_TRANS_DUR lower (this is the time the pusher takes to ramp up, 1 second should be good)\n",
          "type": "issue_comment"
        },
        {
          "author": "melisab",
          "created_at": "2016-06-18T01:38:01Z",
          "body": "The problem with relying on ground speed is that when there is tailwind then there won't be enough lift to transition from MC to FW.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-06-18T01:43:06Z",
          "body": "@melisab relying on fixed throttle settings is not the same as relying on ground speed. this would however only work when the fixed throttle is significantly above stall speed.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-06-21T20:03:49Z",
          "body": "@tumbili time based blending is in\n",
          "type": "issue_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2016-06-22T09:16:09Z",
          "body": "@sanderux This needs testing now. I'll do some basic tests in SITL.\n",
          "type": "issue_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2016-06-22T11:27:10Z",
          "body": "@sanderux Tested all three modes in SITL, works as expected.\n",
          "type": "issue_comment"
        },
        {
          "author": "sanderux",
          "created_at": "2016-06-22T11:46:16Z",
          "body": "@tumbili considering all these changes only have impact on disabled airspeed sensor i see no possibility for regression. I think it's safe to merge this but i'll leave that up to you. I will test fly but that might be a while.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-06-22T13:43:55Z",
          "body": "@tumbili The publish logic for EKF1 is missing, which is what planes are using still today.\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "Added tracker to navigator to record the recent path.",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4726",
    "number": 4726,
    "created_at": "2016-06-03T12:23:06Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "samuelsadok",
      "body": "A tracker module for the navigator records the recently flown path. A new flight mode is introduced to enable flying back along this path (though it doesn't look smooth yet).\n",
      "issue_comments": [
        {
          "author": "PX4BuildBot",
          "created_at": "2016-10-19T19:53:06Z",
          "body": "Can one of the admins verify this patch?\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-10-19T23:04:13Z",
          "body": "@samuelsadok can you rebase?\n",
          "type": "issue_comment"
        },
        {
          "author": "samuelsadok",
          "created_at": "2016-10-23T13:57:25Z",
          "body": "This pull request is now superseded by #5735. I therefore recommend to focus on that new request and suggest we close this one.\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "more follow target updates",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4649",
    "number": 4649,
    "created_at": "2016-05-26T18:47:23Z",
    "merged": true,
    "merged_at": "2016-05-27T20:28:31Z",
    "state": "closed",
    "conversation": {
      "author": "catch-twenty-two",
      "body": "Testing completed ready to merge.  Refactor of follow target module for readability and complexity.  Fixed yaw smoothing.\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-05-27T20:28:35Z",
          "body": "Rebased and applied, thanks!\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "stop spamming console with navigator timeout warnings",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4583",
    "number": 4583,
    "created_at": "2016-05-19T20:02:10Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "kd0aij",
      "body": "report timeout only once per gps loss (added missing line to clear global_pos_available_once, which isn't referenced anywhere else)\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-05-19T20:10:43Z",
          "body": "neat!\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-05-19T20:18:19Z",
          "body": "Rebased and applied.\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "adjust stack sizes and cleanup ignored warnings",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4581",
    "number": 4581,
    "created_at": "2016-05-19T19:09:46Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "dagar",
      "body": "I enabled   CONFIG_ARMV7M_STACKCHECK and adjusted some of the insufficient stack sizes I saw. There are still more modules to check and I still did get the system fully running. Once we have a hardware test harness I think we should have a build with stackcheck enabled. Alternatively if the overhead is acceptable we could keep it enabled on px4fmu-v4.\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-05-19T19:43:19Z",
          "body": "Thanks, this is awesome!\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-05-19T19:45:20Z",
          "body": "The main reason to not have it on by default is that it draws a ton of CPU power. But we should indeed have proper test runs. The fact that you adjusted so much clearly shows that we have an unresolved process issue here.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-05-19T19:49:58Z",
          "body": "Rebased and applied.\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-05-19T19:56:16Z",
          "body": "The NuttX wiki claims 30% to 35% additional CPU utilization which is huge, but maybe better than the alternative?\n\nI should emphasize this was only with a pixhawk configured for fixed wing and I didn't even get the system fully booted. I'm guessing there's going to be a lot more.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-05-19T20:09:06Z",
          "body": "@dagar The other thing to keep in mind is that the instrumentation itself draws memory. So this could be all a false alarm. The reported usage of the high watermarks in top is pretty accurate.\n",
          "type": "issue_comment"
        },
        {
          "author": "davids5",
          "created_at": "2016-05-19T20:34:42Z",
          "body": "@LorenzMeier and @dagar \nI may need revisit the headroom on master....\nThe water mark is large. If we have plenty or RAM then the \"larger than needed headroom\" is moot. If not, the values gleaned from `top` will be a good indicator of penetration just not large chunk overflow.\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-05-19T23:10:44Z",
          "body": "Alright we won't panic over these potential stack issues, but for peace of mind let's work towards a build that runs cleanly with stack check enabled. I've added the idea to the testing wishlist #4532.\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-05-19T19:42:14Z",
          "body": "That's a steep increase - does the start handler really need more stack? Or did you intent to increase the main app stack? Which would be in task_spawn, NOT here.\n",
          "path": "src/modules/sensors/CMakeLists.txt",
          "position": 5,
          "type": "review_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-05-19T19:47:27Z",
          "body": "Disregard that - I'm pretty sure its valid and intended.\n",
          "path": "src/modules/sensors/CMakeLists.txt",
          "position": 5,
          "type": "review_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-05-19T19:50:28Z",
          "body": "This shouldn't have made it in. When stackcheck is enabled sensors is somehow causing a hard fault when the main exits. I tried throwing a ton of stack at it.\n",
          "path": "src/modules/sensors/CMakeLists.txt",
          "position": 5,
          "type": "review_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-05-19T19:58:50Z",
          "body": "Are you sure its causing a hard fault or rather entering the stack check trap?\n",
          "path": "src/modules/sensors/CMakeLists.txt",
          "position": 5,
          "type": "review_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-05-19T20:01:37Z",
          "body": "I've reset it for now to 1200. But I would appreciate your feedback.\n",
          "path": "src/modules/sensors/CMakeLists.txt",
          "position": 5,
          "type": "review_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-05-19T23:15:02Z",
          "body": "It was a hard fault in up_switchcontext.S according to the PC.\n",
          "path": "src/modules/sensors/CMakeLists.txt",
          "position": 5,
          "type": "review_comment"
        }
      ],
      "reviews": []
    }
  },
  {
    "title": "orb macros: cleanup some unused code",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4576",
    "number": 4576,
    "created_at": "2016-05-19T08:17:18Z",
    "merged": true,
    "merged_at": "2016-05-19T09:08:37Z",
    "state": "closed",
    "conversation": {
      "author": "bkueng",
      "body": "",
      "issue_comments": [],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "Param metadata",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4540",
    "number": 4540,
    "created_at": "2016-05-14T00:32:29Z",
    "merged": true,
    "merged_at": "2016-05-14T09:20:28Z",
    "state": "closed",
    "conversation": {
      "author": "dagar",
      "body": "Param metadata cleanup as discussed here. https://github.com/mavlink/qgroundcontrol/issues/3012#issuecomment-219168089\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-05-14T09:14:53Z",
          "body": "Thanks!\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "Bring SITL back to life",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4533",
    "number": 4533,
    "created_at": "2016-05-13T16:38:30Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "julianoes",
      "body": "Reverted the evil commit, works again.\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-05-13T18:46:13Z",
          "body": "I'll try to fix it proper. I have flown dozens of times in jMAVSim without any regression - can you explain the steps to repro?\n",
          "type": "issue_comment"
        },
        {
          "author": "julianoes",
          "created_at": "2016-05-13T18:48:44Z",
          "body": "```\ngit checkout master\ngit submodule update\nmake clean\nmake posix gazebo\n```\n\nThen wait for home, and do `commander takeoff` and it slides along, flips and the estimator goes towards Rapperswil. :smiley: \n\nAnd for jMAVSim, the same, it just doesn't crash as bad but it kinda slides along.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-05-13T18:50:08Z",
          "body": "Can you get me a screenshot of the Accel Z measurements of your fixed state? I'd like to see how they look when its idle on the ground.\n",
          "type": "issue_comment"
        },
        {
          "author": "julianoes",
          "created_at": "2016-05-13T18:54:37Z",
          "body": "![terrible_accel](https://cloud.githubusercontent.com/assets/1419688/15258621/e2477eb4-194c-11e6-9ed2-05ac0de5641e.png)\nYer that looks pretty terrible.\n",
          "type": "issue_comment"
        },
        {
          "author": "julianoes",
          "created_at": "2016-05-13T18:56:30Z",
          "body": "That would explain the bad flight performance with lots of slow oscillations in gazebo but that's another issue.\n\nThis is a general takeoff issue that affects definitely both jMAVSim and gazebo.\n\nSome setpoint is not set correctly, because it does the takeoff jump but then just slides along without proper setpoints.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-05-13T19:38:58Z",
          "body": "What are the steps with jMAVsim to repro?\n",
          "type": "issue_comment"
        },
        {
          "author": "julianoes",
          "created_at": "2016-05-13T19:47:21Z",
          "body": "Same thing.\n\n```\ngit checkout master\ngit submodule update\nmake clean\nmake posix jmavsim\n```\n\n```\ncommander takeoff\n```\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-05-13T19:51:23Z",
          "body": "Got it. This must actually be much more recent than the commit you bisected. Because I tested that commit that way.\n",
          "type": "issue_comment"
        },
        {
          "author": "julianoes",
          "created_at": "2016-05-13T20:01:58Z",
          "body": "Well I did a bisect and that's what I got.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-05-13T20:03:58Z",
          "body": "I was inaccurate. I did fire the takeoff command via QGC, not shell. And it turns out the shell version did not stick to the API. I just fixed that and now things behave.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-05-13T20:06:26Z",
          "body": "I also replaced EKF2 with LPE in SITL. You should find your workflow to be back to bearable. Still looking into speeding up boot time.\n",
          "type": "issue_comment"
        },
        {
          "author": "julianoes",
          "created_at": "2016-05-13T20:09:43Z",
          "body": "Aha, nice catch!\n\nThanks.\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "Navigator: Only run FOH logic when in mission mode",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4494",
    "number": 4494,
    "created_at": "2016-05-10T08:14:16Z",
    "merged": true,
    "merged_at": "2016-05-10T11:59:25Z",
    "state": "closed",
    "conversation": {
      "author": "LorenzMeier",
      "body": "@tumbili This should fix #4491. Please test in SITL and real flights.\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-05-10T09:18:58Z",
          "body": "Jenkins test this please\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "WIP: Pr topic att sp cleanup",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4478",
    "number": 4478,
    "created_at": "2016-05-07T12:02:56Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "RomanBapst",
      "body": "",
      "issue_comments": [
        {
          "author": "RomanBapst",
          "created_at": "2016-05-07T12:04:35Z",
          "body": "@birchera This is the vehicle attitude setpoint cleanup WIP. For now it compiles but I will go through it and implement functions in the matrix lib which can be used all over the code.\n",
          "type": "issue_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2016-07-20T13:23:36Z",
          "body": "Replaced by #5105 \n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "Param metadata",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4472",
    "number": 4472,
    "created_at": "2016-05-06T22:23:51Z",
    "merged": true,
    "merged_at": "2016-05-11T16:47:26Z",
    "state": "closed",
    "conversation": {
      "author": "dagar",
      "body": "This mainly adds increment and decimal to fixed wing params.\n\nOne thing to note is that increment and decimal for `@unit norm` (0-1.0) is somewhat confusing. Those actually apply to the QGC formatted percent (0-100).\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-05-07T09:06:14Z",
          "body": "Can you fix the decimal and increment to relate to the norm field, not to the percentage? The improper scaling should be fixed on the QGC side instead.\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-05-08T00:49:56Z",
          "body": "Yes that sounds like the better solution. I'll take a look.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-05-08T09:30:06Z",
          "body": "@dagar Here is the QGC support for that (screenshot included against meta data from master):\nhttps://github.com/mavlink/qgroundcontrol/pull/3346\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-05-11T07:46:51Z",
          "body": "@dagar Did you get a chance to rework the patch here to have the proper units? The QGC change is in and released, so all that's missing is really getting this PR in.\n",
          "type": "issue_comment"
        },
        {
          "author": "dagar",
          "created_at": "2016-05-11T16:36:44Z",
          "body": "I fixed the @norm usage. QGC params already looked much better with just your change.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-05-11T16:49:07Z",
          "body": "Thanks merged!\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "Auto take-off corner case: Reset work item type when landed",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4420",
    "number": 4420,
    "created_at": "2016-05-03T12:10:25Z",
    "merged": true,
    "merged_at": "2016-05-03T12:13:17Z",
    "state": "closed",
    "conversation": {
      "author": "mswingtra",
      "body": "If the auto mission is paused/aborted during take-off and we land in manual mode, then work_item_type needs to be reset unless we re-power. Otherwise, it is set to WORK_ITEM_TYPE_TAKEOFF, and take-off waypoint is treated as normal position waypoint next time mission is launched. Thus, controller does not use take-off logic but position control logic. \n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-05-03T12:13:30Z",
          "body": "Thanks!\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "FW add mavlink NAV_CONTROLLER_OUTPUT",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4363",
    "number": 4363,
    "created_at": "2016-04-25T18:15:08Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "dagar",
      "body": "This implements mavlink NAV_CONTROLLER_OUTPUT to show altitude and airspeed error for fixed wing.\nhttp://mavlink.org/messages/common#NAV_CONTROLLER_OUTPUT\n",
      "issue_comments": [
        {
          "author": "LorenzMeier",
          "created_at": "2016-04-26T07:48:12Z",
          "body": "Looking good. Will merge once we have 1.3.0 out.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-05-13T10:56:26Z",
          "body": "Rebased and applied.\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "Support for reposition MAVLink command",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4347",
    "number": 4347,
    "created_at": "2016-04-23T18:13:57Z",
    "merged": true,
    "merged_at": "2016-04-24T14:54:11Z",
    "state": "closed",
    "conversation": {
      "author": "LorenzMeier",
      "body": "@dagar @DonLakeFlyer This implements the reposition command. Now I need QGC support / implementing it in order to finish the testing. Pretty close though and will go into 1.3.0.\n",
      "issue_comments": [],
      "review_comments": [],
      "reviews": []
    }
  },
  {
    "title": "Better granularity for flight failsafe modes",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/4344",
    "number": 4344,
    "created_at": "2016-04-23T14:54:59Z",
    "merged": false,
    "merged_at": null,
    "state": "closed",
    "conversation": {
      "author": "LorenzMeier",
      "body": "@kd0aij Testing this with props off would be great. Main documentation:\n\n``` C++\n/**\n * Set data link loss failsafe mode\n *\n * The data link loss failsafe will only be entered after a timeout,\n * set by COM_RC_LOSS_T in seconds.\n *\n * @value 0 Disabled\n * @value 1 Loiter\n * @value 2 Return to Land\n * @value 3 Land at current position\n * @value 4 Outback Challenge (OBC) rules\n *\n * @group Mission\n */\nPARAM_DEFINE_INT32(NAV_DLL_ACT, 0);\n\n/**\n * Set RC loss failsafe mode\n *\n * The RC loss failsafe will only be entered after a timeout,\n * set by COM_RC_LOSS_T in seconds. If the timeout value is smaller than\n * zero it will never be entered. If RC input checks have been disabled\n * by setting the COM_RC_IN_MODE param it will also not be triggered.\n *\n * @value 0 Disabled\n * @value 1 Loiter\n * @value 2 Return to Land\n * @value 3 Land at current position\n * @value 4 Outback Challenge (OBC) rules\n *\n * @group Mission\n */\nPARAM_DEFINE_INT32(NAV_RCL_ACT, 0);\n```\n\n@DonLakeFlyer The comments above should also be enough to re-do the safety screen. I've broken the param system with this change, I need to think how we address that.\n",
      "issue_comments": [
        {
          "author": "kd0aij",
          "created_at": "2016-04-23T15:09:51Z",
          "body": "For testing this, can \"datalink\" be wifi connection of QGC to pixracer? \n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-04-23T15:10:30Z",
          "body": "Yes, that should trigger it.\n",
          "type": "issue_comment"
        },
        {
          "author": "kd0aij",
          "created_at": "2016-04-23T15:56:22Z",
          "body": "first test of RC loss with option 3 gave no feedback on console or QGC and motor speed did not change\n\nalso getting this on the console:\n\n```\nWARN  Failed to open MAVLink log: /fs/microsd/msgs_2016_04_23_15_53_43.txt@ï¿½ errno=22\nWARN  Failed to open MAVLink log: /fs/microsd/msgs_2016_04_23_15_53_48.txt@ï¿½ errno=22\nWARN  Failed to open MAVLink log: /fs/microsd/msgs_2016_04_23_15_53_48.txt@ï¿½ errno=22\n```\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-04-23T16:15:03Z",
          "body": "@kd0aij If you get these you need to wipe your SD card. File system fail.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-04-23T16:15:58Z",
          "body": "Its possible that the motor speed is not changing if the system believes it already is landed. But I need to check.\n",
          "type": "issue_comment"
        },
        {
          "author": "kd0aij",
          "created_at": "2016-04-23T16:20:20Z",
          "body": "is there a console or mavlink message indicating failsafe is engaged?\n",
          "type": "issue_comment"
        },
        {
          "author": "kd0aij",
          "created_at": "2016-04-23T16:27:51Z",
          "body": "refetched, cleaned and reflashed. RC loss results in QGC \"Landing\" mode and much later \"failsafe mode on\". No messages on console. Motors sped up and stayed at that speed for several minutes. What is supposed to happen?\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-04-23T16:28:59Z",
          "body": "That sounds about right. It would have landed on-spot.\n",
          "type": "issue_comment"
        },
        {
          "author": "kd0aij",
          "created_at": "2016-04-23T16:29:47Z",
          "body": "motors never stop?\n",
          "type": "issue_comment"
        },
        {
          "author": "kd0aij",
          "created_at": "2016-04-23T16:31:31Z",
          "body": "battery voltage reading in QGC is erratic... critical battery warning with FrSky telemetry showing 11.1V\n",
          "type": "issue_comment"
        },
        {
          "author": "kd0aij",
          "created_at": "2016-04-23T16:32:35Z",
          "body": "I have an ACSP5 on this PixRacer\n",
          "type": "issue_comment"
        },
        {
          "author": "kd0aij",
          "created_at": "2016-04-23T16:37:33Z",
          "body": "Why isn't there an RC failsafe option to kill the motors? Is that the OBC mode?\n@LorenzMeier Does the copter disarm after \"land at current position\" when RC is lost?\n",
          "type": "issue_comment"
        },
        {
          "author": "kd0aij",
          "created_at": "2016-04-23T17:53:07Z",
          "body": "Killing the wifi link while armed in manual mode didn't appear to do anything, but I guess there's intentionally no feedback on the console?\n",
          "type": "issue_comment"
        },
        {
          "author": "kd0aij",
          "created_at": "2016-05-02T23:05:08Z",
          "body": "@LorenzMeier I see you merged this with open questions from me... Were there other test results which were more definitive? I tried this again today with the copter tied down, but the \"land at current position\" motor behavior seemed wrong, and it went to high throttle when I turned the TX back on, so I don't trust that option. So as far as I can tell, there's no safe option available to prevent a fly-away on RC loss.\n",
          "type": "issue_comment"
        },
        {
          "author": "LorenzMeier",
          "created_at": "2016-05-03T07:44:18Z",
          "body": "You will need to try this on a tether, rather than tied down. If its close to home it will land straight, if it is not close to home it will RTL.\n",
          "type": "issue_comment"
        },
        {
          "author": "kd0aij",
          "created_at": "2016-05-03T13:23:06Z",
          "body": "is a GPS lock required?\n\nOn Tue, May 3, 2016 at 1:44 AM Lorenz Meier notifications@github.com\nwrote:\n\n> You will need to try this on a tether, rather than tied down. If its close\n> to home it will land straight, if it is not close to home it will RTL.\n> \n> â€”\n> You are receiving this because you were mentioned.\n> Reply to this email directly or view it on GitHub\n> https://github.com/PX4/Firmware/pull/4344#issuecomment-216460164\n",
          "type": "issue_comment"
        },
        {
          "author": "kd0aij",
          "created_at": "2016-05-30T14:37:58Z",
          "body": "apparently this needs more testing, but I would need more explanation of expected results to be able to test it safely: https://github.com/PX4/Firmware/issues/4674\n",
          "type": "issue_comment"
        },
        {
          "author": "xn365",
          "created_at": "2016-05-31T13:47:01Z",
          "body": "https://github.com/PX4/Firmware/blob/master/src/modules/navigator/navigator_main.cpp#L344\nI think navigator will not working When we don't have gps.\nCould AUTOLAND or LANDGPSFAIL mode run in this case?\nhttps://github.com/PX4/Firmware/blob/master/src/modules/commander/state_machine_helper.cpp#L615\nWe will chang to DESCEND mode in the case of  RC lost and have no GPS.\nBut this line will never be reached when we have no GPS :https://github.com/PX4/Firmware/blob/master/src/modules/navigator/navigator_main.cpp#L566\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": []
    }
  }
]