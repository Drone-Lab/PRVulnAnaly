[
  {
    "title": "Navigator RTL: run find_RTL_destination() only on_inactive",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/21782",
    "number": 21782,
    "created_at": "2023-06-30T10:13:08Z",
    "merged": true,
    "merged_at": "2023-07-04T07:36:22Z",
    "state": "closed",
    "conversation": {
      "author": "sfuhrer",
      "body": "\r\n### Solved Problem\r\nRTL::find_RTL_destination() is called also when the RTL has already started, and can override the set _destination etc. I don't think that's desired.\r\n\r\nThis was introduced through a refactor commit: https://github.com/PX4/PX4-Autopilot/pull/21208/commits/2bff49475b504b29eba8fb5cf1cb65400ea80482\r\n\r\n### Solution\r\nRemove it again.\r\n\r\n### Changelog Entry\r\nFor release notes:\r\n```\r\nBugfix: RTL: do not edit RTL destination once RTL is started\r\n```\r\n\r\n\r\n### Test coverage\r\n- Unit/integration test: ...\r\n- Simulation/hardware testing logs: https://review.px4.io/\r\n\r\n",
      "issue_comments": [],
      "review_comments": [],
      "reviews": [
        {
          "author": "RomanBapst",
          "created_at": "",
          "body": "",
          "state": "APPROVED",
          "type": "review"
        },
        {
          "author": "MaEtUgR",
          "created_at": "",
          "body": "I assume this is only there such that active and inactive are the same.\r\nThe `_destination_check_time` gets reset now even if the digestion does not change. That's not a problem in my eyes. When you switch out of RTL and in again within less than a second then the old destination stays. Maybe that's even a feature. It could be named `_slow_rate_timestamp` or so.",
          "state": "APPROVED",
          "type": "review"
        }
      ]
    }
  },
  {
    "title": "Navigator: loiter: remove unnecessary _loiter_pos_set",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/21776",
    "number": 21776,
    "created_at": "2023-06-29T12:50:08Z",
    "merged": true,
    "merged_at": "2023-06-30T13:40:21Z",
    "state": "closed",
    "conversation": {
      "author": "sfuhrer",
      "body": "### Solved Problem\r\nWhile working on https://github.com/PX4/PX4-Autopilot/pull/21775 I noticed this seemingly unnecessary class variable `_loiter_pos_set`, that was set to false in `on_inactive()` or in `on_active`, and then though only ever checked in `on_activation` (through `set_loiter_position()`). I don't see how it could be false when entering on_activation(), and thus can just be removed, or am I missing something?\r\n\r\n### Solution\r\nRemove it!\r\n\r\n### Changelog Entry\r\nFor release notes:\r\n```\r\nRefactor: remove unnecessary variable\r\n```\r\n\r\n### Test coverage\r\nBit of SITL testing.\r\n\r\n",
      "issue_comments": [
        {
          "author": "junwoo091400",
          "created_at": "2023-06-30T14:39:16Z",
          "body": "![image](https://github.com/PX4/PX4-Autopilot/assets/23277211/50c94e3d-b230-4dd2-946f-cea632b8088c)\r\n\r\nIdk why but the merge commit in main branch itself doesn't show these build failures, any clue why in this PR page itself it shows so many build errors? @MaEtUgR ",
          "type": "issue_comment"
        }
      ],
      "review_comments": [
        {
          "author": "MaEtUgR",
          "created_at": "2023-06-30T12:03:23Z",
          "body": "```suggestion\r\n```",
          "path": "src/modules/navigator/loiter.h",
          "position": 1,
          "type": "review_comment"
        }
      ],
      "reviews": [
        {
          "author": "MaEtUgR",
          "created_at": "",
          "body": "It was introduced here: https://github.com/PX4/PX4-Autopilot/commit/8960ab3402a87b182d17ab1b3cb165115e0f4bad\r\nBut I cannot possibly understand what for. Maybe an unfinished thought about setting the loiter position once armed when already being in hold mode but I'm pretty sure it never worked correctly since as you mention the loiter point is never set again once hold mode is engaged 🤷‍♂️\r\n\r\nMaybe a draft implementation contained a second call to `set_loiter_position()` and that's where it had an effect.\r\n\r\nI also did some tests and I cannot find a case to enter the loiter's `on_activation()` with the flag true.",
          "state": "DISMISSED",
          "type": "review"
        }
      ]
    }
  },
  {
    "title": "Navigator: Loiter: always establish new Loiter with center at current position",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/21775",
    "number": 21775,
    "created_at": "2023-06-29T12:43:22Z",
    "merged": true,
    "merged_at": "2023-07-04T07:35:41Z",
    "state": "closed",
    "conversation": {
      "author": "sfuhrer",
      "body": "### Solved Problem\r\nhttps://github.com/PX4/PX4-Autopilot/issues/21702\r\n\r\nVehicle keeps flying towards Loiter waypoint if Hold mode is selected. In the past we within Navigator set the type to POSITION when far away from a Loiter waypoint, and then only to LOITER when really on established loiter, but this distinction is now no longer part of Navigator and the FW position controller handles it.\r\n\r\n### Solution\r\nWhen switching into Hold mode establish a Loiter around current position, even if we were before already loitering (eg in Mission mode). This results in the same behavior when switching into Hold/Loiter mode directly (either through RC switch or in the flight mode selection in QGC) or through the \"Hold\" button in QGC (which sends a DO_REPOSITION with the fields at the current position). \r\n\r\nIn this screen recording you see the behavior prior and after this PR.\r\nhttps://github.com/PX4/PX4-Autopilot/assets/26798987/9079b575-77fc-40a2-be54-b3c11816cca3\r\n\r\n### Changelog Entry\r\nFor release notes:\r\n```\r\nBugfix: Fixed-wing: Always establish loiter around current position when switching into Hold mode\r\n```\r\n\r\n\r\n### Alternatives\r\nFix detection on whether we're currently on an established loiter, and in that case don't loiter around current position but keep established loiter. Personally I though prefer to stick to Hold = Loiter around current position always. Imagine being on a huge loiter. If the vehicle then keeps following it it's hardly anymore \"Holding position\". \r\n\r\n",
      "issue_comments": [
        {
          "author": "sfuhrer",
          "created_at": "2023-06-30T18:26:40Z",
          "body": "> But while testing that I found that when I press pause in QGC it actually flies to the next waypoint still and stops there. The code changed it here not called at all in this case probably because of the reposition command like you wrote.\r\n\r\nWhich QGC version did you test with? I couldn't reproduce with mine (v4.2.6 from this March). But yes, like you said not affected by this PR.",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": [
        {
          "author": "MaEtUgR",
          "created_at": "",
          "body": "Makes sense to me.\r\nI tested and with the multirotor I could not get it to not stop when just changing to hold mode also before.\r\n\r\nBut while testing that I found that when I press pause in QGC it actually flies to the next waypoint still and stops there. The code changed it here not called at all in this case probably because of the reposition command like you wrote.",
          "state": "APPROVED",
          "type": "review"
        }
      ]
    }
  },
  {
    "title": "Some parameter cleanup",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/21736",
    "number": 21736,
    "created_at": "2023-06-19T10:13:47Z",
    "merged": true,
    "merged_at": "2023-07-17T08:35:03Z",
    "state": "closed",
    "conversation": {
      "author": "sfuhrer",
      "body": "### Solved Problem\r\nSafes a bit of flash and reduces entropy by removing two params that aren't really required anymore. \r\n\r\n### Solution\r\n\r\n### Changelog Entry\r\n\r\n```\r\nRemove COM_ARM_ARSP_EN and VT_B_DEC_FF params, plus shorten parameter descriptions\r\n```\r\n\r\n",
      "issue_comments": [
        {
          "author": "DronecodeBot",
          "created_at": "2024-07-25T00:45:43Z",
          "body": "This pull request has been mentioned on **Discussion Forum for PX4, Pixhawk, QGroundControl, MAVSDK, MAVLink**. There might be relevant details there:\n\nhttps://discuss.px4.io/t/px4-v1-15-public-changes-what-needs-docs/39850/1\n",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": [
        {
          "author": "bresch",
          "created_at": "",
          "body": "",
          "state": "APPROVED",
          "type": "review"
        }
      ]
    }
  },
  {
    "title": "Navigator: Resume mission with last flight speed",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/21714",
    "number": 21714,
    "created_at": "2023-06-12T16:34:18Z",
    "merged": true,
    "merged_at": "2023-08-08T11:22:05Z",
    "state": "closed",
    "conversation": {
      "author": "sfuhrer",
      "body": "Based on https://github.com/PX4/PX4-Autopilot/pull/21710\r\n\r\n### Solved Problem\r\nOn resuming a mission, the flight speed was reset to the vehicle default. Especially for surveys this is not acceptable. \r\n\r\n### Solution\r\nFurther extend the ideas from https://github.com/PX4/PX4-Autopilot/pull/21710: some mission items contain not momentary setpoints (like go to point A), but instead contain settings that are then relevant for the whole mission (or until over-turned by a negating command). \r\nDO_CHANGE_SPEED items belong to the same category as eg camera settings: you want to re-apply them when resuming a mission. \r\n\r\nI've further removed the separated mc/fw stored flight speeds, as it's only ever needed to store the speed of the current mode we're in, and we reset it during VTOL transitions. \r\n\r\n### Changelog Entry\r\n\r\n```\r\nFeature: Resume mission with flight speed from previous mission items\r\nDocumentation: Need to clarify page ...\r\n```\r\n\r\n### Alternatives\r\n\r\n\r\n",
      "issue_comments": [
        {
          "author": "DronecodeBot",
          "created_at": "2023-06-14T09:43:32Z",
          "body": "This pull request has been mentioned on **Discussion Forum for PX4, Pixhawk, QGroundControl, MAVSDK, MAVLink**. There might be relevant details there:\n\nhttps://discuss.px4.io/t/set-mission-speed-being-ignored-upon-starting-auto-flight/32705/2\n",
          "type": "issue_comment"
        },
        {
          "author": "tstastny",
          "created_at": "2023-06-23T12:20:00Z",
          "body": "will likely need this in before the beaglebone is passing https://github.com/PX4/PX4-Autopilot/pull/21749",
          "type": "issue_comment"
        },
        {
          "author": "sfuhrer",
          "created_at": "2023-07-17T13:57:40Z",
          "body": "[Removed some speed handling logic from Navigator,](https://github.com/PX4/PX4-Autopilot/pull/21714/commits/0b18bd59a46268574460aa9b60f0e13cea5aa36e) and then rebased and force pushed. @tstastny would be good if you could make yourself a picture here and comment if you agree with the general direction of it (removing speed logic from Navigator). ",
          "type": "issue_comment"
        },
        {
          "author": "hamishwillee",
          "created_at": "2023-08-09T04:56:52Z",
          "body": "I think it is an excellent feature to start from the previous setpoint. Can you update the docs @sfuhrer ? \r\n\r\nI was thinking perhaps a very short section on pausing and resuming the mission in https://docs.px4.io/main/en/flight_modes/mission.html#mission-mode. Make it clear this applies to all frames.",
          "type": "issue_comment"
        }
      ],
      "review_comments": [
        {
          "author": "tstastny",
          "created_at": "2023-06-23T12:09:34Z",
          "body": "if this is just about speed commands, shouldnt we just look here for the exact NAV_CMD corresponding to a DO_CHANGE_SPEED?\r\n\r\nAlso - why are we sending the command again instead of just applying the properties? (sorry im a bit out of the loop on all this)",
          "path": "src/modules/navigator/mission.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "tstastny",
          "created_at": "2023-06-23T12:10:23Z",
          "body": "i dont really care either way - but what's the reason for keeping these lines at all if they are commented out?",
          "path": "src/modules/navigator/navigator.h",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "tstastny",
          "created_at": "2023-06-23T12:18:45Z",
          "body": "so this one\r\n1. updates to the latest potential speed change ONLY by the mission item iteration\r\n2. and then sends the vehicle command such that\r\n3. `cruising_speed_sp_update()` picks up that command when it checks for do set speed commands? (where it would also pick up any operator freeform do set speed commands?)\r\n",
          "path": "src/modules/navigator/mission.cpp",
          "position": 14,
          "type": "review_comment"
        },
        {
          "author": "sfuhrer",
          "created_at": "2023-06-23T14:48:54Z",
          "body": "No reason, those are left overs from debugging, will remove!",
          "path": "src/modules/navigator/navigator.h",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "sfuhrer",
          "created_at": "2023-06-23T14:58:44Z",
          "body": "> if this is just about speed commands, shouldnt we just look here for the exact NAV_CMD corresponding to a DO_CHANGE_SPEED?\r\n\r\ngood point, changed it to do so.",
          "path": "src/modules/navigator/mission.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "sfuhrer",
          "created_at": "2023-06-23T15:22:42Z",
          "body": ">ONLY by the mission item iteration\r\nCan you expand what you mean?\r\n\r\nBut yes otherwise that's what happens. Note that also the fixed-wing position controller and the multicopter flight mode manager listen to VEHICLE_CMD_DO_CHANGE_SPEED and execute it independently of `cruising_speed_sp_update()` (which is only run in Mission, but not in eg Loiter). \r\n",
          "path": "src/modules/navigator/mission.cpp",
          "position": 14,
          "type": "review_comment"
        },
        {
          "author": "sfuhrer",
          "created_at": "2023-06-23T15:26:28Z",
          "body": "Maybe we could even remove `cruising_speed_sp_update()`? It's a fundamental question if the speed setpoint should be part of the position setpoint or if it's rather an independent system setting.",
          "path": "src/modules/navigator/mission.cpp",
          "position": 14,
          "type": "review_comment"
        },
        {
          "author": "sfuhrer",
          "created_at": "2023-07-17T13:52:17Z",
          "body": "Removed it in https://github.com/PX4/PX4-Autopilot/pull/21714/commits/0b18bd59a46268574460aa9b60f0e13cea5aa36e. I feel like we should rather de-couple path handling (through the position setpoints) and speed setpoints (independent of the path) for now.",
          "path": "src/modules/navigator/mission.cpp",
          "position": 14,
          "type": "review_comment"
        },
        {
          "author": "sfuhrer",
          "created_at": "2023-07-17T13:54:29Z",
          "body": ">Also - why are we sending the command again instead of just applying the properties? (sorry im a bit out of the loop on all this)\r\n\r\nBecause the speed setpoint is handled by the Navigator but by the Position controllers (FW Pos and MPC). See https://github.com/PX4/PX4-Autopilot/pull/19407. So Navigator has to re-publish the command, and the position controllers can take it up and execute the change.\r\n",
          "path": "src/modules/navigator/mission.cpp",
          "position": 1,
          "type": "review_comment"
        }
      ],
      "reviews": [
        {
          "author": "tstastny",
          "created_at": "",
          "body": "I left some questions, just because navigator is quite nebulous to me. But otherwise great that we are reducing complexity where possible.",
          "state": "DISMISSED",
          "type": "review"
        },
        {
          "author": "sfuhrer",
          "created_at": "",
          "body": "Addressed two of your comments with new commits @tstastny ",
          "state": "COMMENTED",
          "type": "review"
        },
        {
          "author": "RomanBapst",
          "created_at": "",
          "body": "",
          "state": "APPROVED",
          "type": "review"
        },
        {
          "author": "tstastny",
          "created_at": "",
          "body": "",
          "state": "APPROVED",
          "type": "review"
        }
      ]
    }
  },
  {
    "title": "Navigator Mission: Improve mission resume",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/21710",
    "number": 21710,
    "created_at": "2023-06-09T15:07:09Z",
    "merged": true,
    "merged_at": "2023-06-20T12:38:04Z",
    "state": "closed",
    "conversation": {
      "author": "sfuhrer",
      "body": "Replaces https://github.com/PX4/PX4-Autopilot/pull/21643. I've tried to clean up the logic a bit and make it less entangled.\r\n\r\n### Solved Problem\r\nSurvey mission contain, beside the position items, contain items for gimbal config, camera mode config, and camera trigger. When the execution of a mission is stopped, we want also to stop the camera from taking pictures and move the gimbal back to neutral. Upon resuming the mission though, we have to re-configure gimbal and camera and start the triggering once back on the mission path.\r\n\r\n### Solution\r\nStore (cache) all gimbal/camera/trigger mission items and replay them on resuming the mission. In detail:\r\n- `on_inactivation() `store the currently active index as `_inactivation_index`\r\n- `on_activation()`, store all gimbal/camera/trigger items up to the currently active index and reset the mission to the previous. Also set flag (`_align_heading_necessary`) that a yaw alignment is required upon reaching this waypoint (we want to only start triggering once yaw is correctly aligned with next WP).\r\n- `on_active()`\r\n  - if `_align_heading_necessary` is set and mission item is reached, update current item with yaw field and force it to accept that one before starting the trigger.\r\n  - read the gimbal and camera mode command items from cache, thus making the gimbal move to the right orientation and setting the right camera mode\r\n  - read the trigger commands once the previous waypoint incl. yaw alignment is accepted\r\n\r\nFurther:\r\n- reset cached items if mission is updated\r\n- reset mission on disarmed only if we reached the last mission item, otherwise keep\r\n\r\n### Changelog Entry\r\nFor release notes:\r\n```\r\nFeature: Improve mission resume (e.g. replay gimbal and camera commands of a survey)\r\nDocumentation: Need to clarify page\r\n```\r\n\r\n### Alternatives\r\nIt would be nice to not resume the mission from the previous mission item but from the actual lat/lon position where the mission was interrupted. \r\n\r\n### Test coverage\r\nSITL tested.\r\n\r\n\r\n\r\n",
      "issue_comments": [
        {
          "author": "RomanBapst",
          "created_at": "2023-06-16T06:35:14Z",
          "body": "@sfuhrer LGTM. I hard a hard time understanding how the mission item is set when resuming the survey without calling `set_mission_items` but then I realized that `set_current_mission_index` does it under the hood :-p",
          "type": "issue_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2023-06-18T16:46:37Z",
          "body": "@sfuhrer Flash overflow :-(",
          "type": "issue_comment"
        },
        {
          "author": "sfuhrer",
          "created_at": "2023-06-19T09:11:53Z",
          "body": "> @sfuhrer Flash overflow :-(\r\n\r\nv4_test indeed is at 100.00%..in an effort to bring it slightly down I've removed some rather unnecessary params and made some other param descriptions more compact, let's see if that's enough. ",
          "type": "issue_comment"
        },
        {
          "author": "sfuhrer",
          "created_at": "2023-06-19T10:05:39Z",
          "body": "> > @sfuhrer Flash overflow :-(\r\n> \r\n> v4_test indeed is at 100.00%..in an effort to bring it slightly down I've removed some rather unnecessary params and made some other param descriptions more compact, let's see if that's enough.\r\n\r\nThat wasn't enough. I've proposed to remove the gyro FFT instead: https://github.com/PX4/PX4-Autopilot/pull/20811",
          "type": "issue_comment"
        }
      ],
      "review_comments": [
        {
          "author": "RomanBapst",
          "created_at": "2023-06-16T06:22:23Z",
          "body": "```suggestion\r\n\t\t// add yaw alignment requirement on the current mission item\r\n```",
          "path": "src/modules/navigator/mission.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2023-06-16T06:29:45Z",
          "body": "@sfuhrer Can you make a comment why this is necessary here?",
          "path": "src/modules/navigator/mission.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2023-06-16T06:31:17Z",
          "body": "@sfuhrer Can these functions be made const?",
          "path": "src/modules/navigator/mission.h",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2023-06-16T06:32:02Z",
          "body": "```suggestion\r\n\tint _inactivation_index{-1}; // index of mission item at which the mission was paused. Used to resume survey missions at previous waypoint to not lose images.\r\n```",
          "path": "src/modules/navigator/mission.h",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "RomanBapst",
          "created_at": "2023-06-16T06:41:08Z",
          "body": "@sfuhrer I am trying to think about a stupid corner case. What if the user sets the current mission index to the resume index manually while the vehicle is paused. Then he engages RTL and cancels RTL. Then he resumes the mission.\r\nThe `_mission_item` would have been overriden by RTL (shared item) and `_current_mission_index` would be equal to `resume_index`in which case `set_current_mission_index` does an early return. Is that a potential corner case where the mission would fly to the RTL item?",
          "path": "src/modules/navigator/mission.cpp",
          "position": 50,
          "type": "review_comment"
        },
        {
          "author": "sfuhrer",
          "created_at": "2023-06-16T09:43:34Z",
          "body": "Well I was actually wanting to ask you the exact same question :sweat_smile: . I actually don't see where it comes from. Reverse mission is only something that's supported in RTL, no? And there we don't care about mission resume camera logic..\r\nRemove it?",
          "path": "src/modules/navigator/mission.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "sfuhrer",
          "created_at": "2023-06-16T09:57:26Z",
          "body": "certainly, done",
          "path": "src/modules/navigator/mission.h",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "sfuhrer",
          "created_at": "2023-06-16T10:05:12Z",
          "body": "removed it.",
          "path": "src/modules/navigator/mission.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "sfuhrer",
          "created_at": "2023-06-16T10:20:19Z",
          "body": "Yes you're right, but it seems that this behavior is already like that without this PR.",
          "path": "src/modules/navigator/mission.cpp",
          "position": 50,
          "type": "review_comment"
        }
      ],
      "reviews": [
        {
          "author": "RomanBapst",
          "created_at": "",
          "body": "Added comments in the code",
          "state": "CHANGES_REQUESTED",
          "type": "review"
        },
        {
          "author": "RomanBapst",
          "created_at": "",
          "body": "",
          "state": "APPROVED",
          "type": "review"
        }
      ]
    }
  },
  {
    "title": "navigator: send commands to anyone listening",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/21697",
    "number": 21697,
    "created_at": "2023-06-07T14:56:50Z",
    "merged": true,
    "merged_at": "2023-06-12T07:41:28Z",
    "state": "closed",
    "conversation": {
      "author": "sfuhrer",
      "body": "### Solved Problem\r\n POI commands that are part of a mission do not work when the gimbal is controlled by a companion computer. \r\n\r\n### Solution\r\nSend commands to anyone listening. \r\n\r\n### Test coverage\r\nWe have been flying with that change for some years now.\r\n\r\n\r\n",
      "issue_comments": [
        {
          "author": "sfuhrer",
          "created_at": "2023-06-07T15:00:10Z",
          "body": "@bkueng @ThomasDebrunner you were looking into this before - do you think this change is needed?",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": [
        {
          "author": "bkueng",
          "created_at": "",
          "body": "I don't remember exactly but I think it's still needed.",
          "state": "APPROVED",
          "type": "review"
        }
      ]
    }
  },
  {
    "title": "(Mission) FeasibilityChecker: remove duplicate line",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/21689",
    "number": 21689,
    "created_at": "2023-06-06T12:53:56Z",
    "merged": true,
    "merged_at": "2023-07-04T09:17:24Z",
    "state": "closed",
    "conversation": {
      "author": "tstastny",
      "body": "<!--\r\n\r\nThank you for your contribution!\r\n\r\nGet early feedback through\r\n- Dronecode Discord: https://discord.gg/dronecode\r\n- PX4 Discuss: http://discuss.px4.io/\r\n- opening a draft pr and sharing the link\r\n\r\n-->\r\n\r\n### Solved Problem\r\nI was poking around code and saw this duplicated line.\r\n\r\n### Solution\r\nremoved it\r\n\r\n### Changelog Entry\r\nN/A\r\n",
      "issue_comments": [
        {
          "author": "mrpollo",
          "created_at": "2023-06-28T17:53:36Z",
          "body": "Thanks @tstastny ",
          "type": "issue_comment"
        }
      ],
      "review_comments": [],
      "reviews": [
        {
          "author": "mcsauder",
          "created_at": "",
          "body": "",
          "state": "APPROVED",
          "type": "review"
        }
      ]
    }
  },
  {
    "title": "Port VTOL mission item resets and QC rework",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/21665",
    "number": 21665,
    "created_at": "2023-05-31T17:45:54Z",
    "merged": true,
    "merged_at": "2023-06-02T08:22:34Z",
    "state": "closed",
    "conversation": {
      "author": "sfuhrer",
      "body": "Port of https://github.com/PX4/PX4-Autopilot/pull/21641 and https://github.com/PX4/PX4-Autopilot/pull/21598 to 1.14",
      "issue_comments": [],
      "review_comments": [],
      "reviews": [
        {
          "author": "RomanBapst",
          "created_at": "",
          "body": "",
          "state": "APPROVED",
          "type": "review"
        }
      ]
    }
  },
  {
    "title": "Adsb warnings fixes",
    "url": "https://github.com/PX4/PX4-Autopilot/pull/21663",
    "number": 21663,
    "created_at": "2023-05-31T12:39:32Z",
    "merged": true,
    "merged_at": "2024-04-22T08:14:39Z",
    "state": "closed",
    "conversation": {
      "author": "asimopunov",
      "body": "- warn about full traffic conflict buffer at 1/60hz.\r\n- add conflict expiry for buffer.\r\n- use only events for buffer full warning. mavlink_log_critical no longer needed.\r\n- use icao address for conflict warnings id, stop using uas_id. UTM_GLOBAL_POSITION assumed deprecated.\r\n- remove mavlink_log_critical warnings. Replaced with events.\r\n- stop spamming when buffer is full. log using px4_info and px4_warn for ulog since events don't show up on flight review or plotjuggler.\r\n- fix warning wording if buffer is full.\r\n- fix missing {1}, {2} etc. from events\r\n\r\n\r\nfollow up on https://github.com/PX4/PX4-Autopilot/pull/21283",
      "issue_comments": [
        {
          "author": "asimopunov",
          "created_at": "2023-09-29T01:05:33Z",
          "body": "@dakejahl Could you please fetch the adsb changes over to your next release? I was asked about this by Will. ",
          "type": "issue_comment"
        },
        {
          "author": "asimopunov",
          "created_at": "2024-04-11T20:13:24Z",
          "body": "> The CI failure happens on main already, but would be a good opportunity to quickly have a look.\r\n\r\n@bkueng hmm\r\nthey pass locally when I run `make tests TESTFILTER=functional-AdsbConflict`\r\nThe build step also passed when the tests were merged here - https://github.com/PX4/PX4-Autopilot/actions/runs/4431457384/job/12034874013\r\n\r\nMaybe it's unrelated - need to look more\r\n\r\nDoes that work-queue error directly point to anything for you?\r\n\r\n```\r\n[1277/1278] Running tests\r\n   Site: c36612c519c7\r\n   Build name: Linux-c++\r\nCreate new tag: 20240411-1954 - Experimental\r\nTest project /__w/PX4-Autopilot/PX4-Autopilot/build/px4_sitl_test\r\n        Start   1: functional-AdsbConflict\r\n  1/140 Test   #1: functional-AdsbConflict ..............................***Failed    0.01 sec\r\nERROR [px4_work_queue] not running\r\nERROR [px4_work_queue] wq:lp_default not available\r\nERROR [px4_work_queue] init failed\r\n[==========] Running 3 tests from 1 test suite.\r\n[----------] Global test environment set-up.\r\n[----------] 3 tests from AdsbConflictTest\r\n[ RUN      ] AdsbConflictTest.detectTrafficConflict\r\n```",
          "type": "issue_comment"
        },
        {
          "author": "asimopunov",
          "created_at": "2024-04-17T14:46:03Z",
          "body": "> The following tests FAILED:\r\n> \t  1 - functional-AdsbConflict (Failed)\r\n\r\n@bkueng It's passing now",
          "type": "issue_comment"
        }
      ],
      "review_comments": [
        {
          "author": "bkueng",
          "created_at": "2024-04-11T06:40:25Z",
          "body": "This removes it but then accesses it in the next lines.\r\nWhy not directly remove them without the extra `expired_conflicts`?",
          "path": "src/lib/adsb/AdsbConflict.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "bkueng",
          "created_at": "2024-04-11T06:41:48Z",
          "body": "they're displayed now in flight review",
          "path": "src/lib/adsb/AdsbConflict.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "bkueng",
          "created_at": "2024-04-11T06:42:56Z",
          "body": "`events::send(events::ID(\"buffer_full\"), events::Log::Notice, \"Too much traffic! Showing all messages from now on\");` (remove the space)",
          "path": "src/lib/adsb/AdsbConflict.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "bkueng",
          "created_at": "2024-04-11T06:45:47Z",
          "body": "The `@description` above contains the details. If you want to add them here as well, please make it more readable. hdg -> heading",
          "path": "src/lib/adsb/AdsbConflict.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "bkueng",
          "created_at": "2024-04-11T06:46:10Z",
          "body": "Same here and below",
          "path": "src/lib/adsb/AdsbConflict.cpp",
          "position": 199,
          "type": "review_comment"
        },
        {
          "author": "bkueng",
          "created_at": "2024-04-11T06:46:49Z",
          "body": "Can you remove this?",
          "path": "src/lib/adsb/AdsbConflict.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "bkueng",
          "created_at": "2024-04-11T06:47:21Z",
          "body": "It is 120",
          "path": "src/lib/adsb/AdsbConflict.h",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "asimopunov",
          "created_at": "2024-04-11T19:33:24Z",
          "body": "Thanks, doesn't look like there was a good reason.\r\nfixed",
          "path": "src/lib/adsb/AdsbConflict.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "asimopunov",
          "created_at": "2024-04-11T19:33:56Z",
          "body": "yup, better?",
          "path": "src/lib/adsb/AdsbConflict.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "bkueng",
          "created_at": "2024-04-17T06:15:29Z",
          "body": "After removing you must ensure the index does not increase otherwise an element is skipped.",
          "path": "src/lib/adsb/AdsbConflict.cpp",
          "position": 34,
          "type": "review_comment"
        },
        {
          "author": "bkueng",
          "created_at": "2024-04-17T07:14:49Z",
          "body": "Yes, thanks",
          "path": "src/lib/adsb/AdsbConflict.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "bkueng",
          "created_at": "2024-04-18T14:10:30Z",
          "body": "Did you mean to add this?",
          "path": "src/lib/adsb/AdsbConflict.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "asimopunov",
          "created_at": "2024-04-18T16:03:49Z",
          "body": "Of course, we don't need it. I'm just being lazy so I don't need to add another time if this CI fails again. I can remove.",
          "path": "src/lib/adsb/AdsbConflict.cpp",
          "position": 1,
          "type": "review_comment"
        },
        {
          "author": "asimopunov",
          "created_at": "2024-04-18T22:22:34Z",
          "body": "removed",
          "path": "src/lib/adsb/AdsbConflict.cpp",
          "position": 1,
          "type": "review_comment"
        }
      ],
      "reviews": [
        {
          "author": "bkueng",
          "created_at": "",
          "body": "The CI failure happens on main already, but would be a good opportunity to quickly have a look.\r\n```\r\nThe following tests FAILED:\r\n\t  1 - functional-AdsbConflict (Failed)\r\n```",
          "state": "COMMENTED",
          "type": "review"
        },
        {
          "author": "bkueng",
          "created_at": "",
          "body": "> Does that work-queue error directly point to anything for you?\r\n\r\nIt's probably unrelated unless the test accesses params.",
          "state": "COMMENTED",
          "type": "review"
        },
        {
          "author": "bkueng",
          "created_at": "",
          "body": ">  @bkueng It's passing now\r\n\r\nNice, thanks",
          "state": "COMMENTED",
          "type": "review"
        },
        {
          "author": "bkueng",
          "created_at": "",
          "body": "",
          "state": "APPROVED",
          "type": "review"
        }
      ]
    }
  }
]